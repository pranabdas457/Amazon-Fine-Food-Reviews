
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{04\_Amazon\_Fine\_Food\_Reviews\_Analysis\_NaiveBayes}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Amazon Fine Food Reviews
Analysis}\label{amazon-fine-food-reviews-analysis}

Data Source: https://www.kaggle.com/snap/amazon-fine-food-reviews

EDA:
https://nycdatascience.com/blog/student-works/amazon-fine-foods-visualization/

The Amazon Fine Food Reviews dataset consists of reviews of fine foods
from Amazon.

Number of reviews: 568,454 Number of users: 256,059 Number of products:
74,258 Timespan: Oct 1999 - Oct 2012 Number of Attributes/Columns in
data: 10

Attribute Information:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Id
\item
  ProductId - unique identifier for the product
\item
  UserId - unqiue identifier for the user
\item
  ProfileName
\item
  HelpfulnessNumerator - number of users who found the review helpful
\item
  HelpfulnessDenominator - number of users who indicated whether they
  found the review helpful or not
\item
  Score - rating between 1 and 5
\item
  Time - timestamp for the review
\item
  Summary - brief summary of the review
\item
  Text - text of the review
\end{enumerate}

\paragraph{Objective:}\label{objective}

Given a review, determine whether the review is positive (rating of 4 or
5) or negative (rating of 1 or 2).

 {[}Q{]} How to determine if a review is positive or negative? {[}Ans{]}
We could use Score/Rating. A rating of 4 or 5 can be cosnidered as a
positive review. A rating of 1 or 2 can be considered as negative one. A
review of rating 3 is considered nuetral and such reviews are ignored
from our analysis. This is an approximate and proxy way of determining
the polarity (positivity/negativity) of a review.

    \section{{[}1{]}. Reading Data}\label{reading-data}

    \subsection{{[}1.1{]} Loading the data}\label{loading-the-data}

The dataset is available in two forms 1. .csv file 2. SQLite Database

In order to load the data, We have used the SQLITE dataset as it is
easier to query the data and visualise the data efficiently.

Here as we only want to get the global sentiment of the recommendations
(positive or negative), we will purposefully ignore all Scores equal to
3. If the score is above 3, then the recommendation wil be set to
"positive". Otherwise, it will be set to "negative".

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        
        
        \PY{k+kn}{import} \PY{n+nn}{sqlite3}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{nltk}
        \PY{k+kn}{import} \PY{n+nn}{string}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfTransformer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{TfidfVectorizer}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{auc}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{porter} \PY{k}{import} \PY{n}{PorterStemmer}
        
        \PY{k+kn}{import} \PY{n+nn}{re}
        \PY{c+c1}{\PYZsh{} Tutorial about Python regular expressions: https://pymotw.com/2/re/}
        \PY{k+kn}{import} \PY{n+nn}{string}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{corpus} \PY{k}{import} \PY{n}{stopwords}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem} \PY{k}{import} \PY{n}{PorterStemmer}
        \PY{k+kn}{from} \PY{n+nn}{nltk}\PY{n+nn}{.}\PY{n+nn}{stem}\PY{n+nn}{.}\PY{n+nn}{wordnet} \PY{k}{import} \PY{n}{WordNetLemmatizer}
        
        \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{Word2Vec}
        \PY{k+kn}{from} \PY{n+nn}{gensim}\PY{n+nn}{.}\PY{n+nn}{models} \PY{k}{import} \PY{n}{KeyedVectors}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        
        \PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k}{import} \PY{n}{tqdm}
        \PY{k+kn}{import} \PY{n+nn}{os}
        \PY{o}{!}pip install pandasql
        \PY{k+kn}{import} \PY{n+nn}{pandasql} \PY{k}{as} \PY{n+nn}{ps}
        \PY{o}{!}pip install kaggle
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Collecting pandasql
  Downloading https://files.pythonhosted.org/packages/6b/c4/ee4096ffa2eeeca0c749b26f0371bd26aa5c8b611c43de99a4f86d3de0a7/pandasql-0.7.3.tar.gz
Requirement already satisfied: numpy in /usr/local/lib/python3.6/dist-packages (from pandasql) (1.14.6)
Requirement already satisfied: pandas in /usr/local/lib/python3.6/dist-packages (from pandasql) (0.22.0)
Requirement already satisfied: sqlalchemy in /usr/local/lib/python3.6/dist-packages (from pandasql) (1.3.1)
Requirement already satisfied: pytz>=2011k in /usr/local/lib/python3.6/dist-packages (from pandas->pandasql) (2018.9)
Requirement already satisfied: python-dateutil>=2 in /usr/local/lib/python3.6/dist-packages (from pandas->pandasql) (2.5.3)
Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.6/dist-packages (from python-dateutil>=2->pandas->pandasql) (1.11.0)
Building wheels for collected packages: pandasql
  Building wheel for pandasql (setup.py) {\ldots} done
  Stored in directory: /root/.cache/pip/wheels/53/6c/18/b87a2e5fa8a82e9c026311de56210b8d1c01846e18a9607fc9
Successfully built pandasql
Installing collected packages: pandasql
Successfully installed pandasql-0.7.3
Requirement already satisfied: kaggle in /usr/local/lib/python3.6/dist-packages (1.5.3)
Requirement already satisfied: urllib3<1.25,>=1.21.1 in /usr/local/lib/python3.6/dist-packages (from kaggle) (1.22)
Requirement already satisfied: six>=1.10 in /usr/local/lib/python3.6/dist-packages (from kaggle) (1.11.0)
Requirement already satisfied: certifi in /usr/local/lib/python3.6/dist-packages (from kaggle) (2019.3.9)
Requirement already satisfied: python-dateutil in /usr/local/lib/python3.6/dist-packages (from kaggle) (2.5.3)
Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from kaggle) (2.18.4)
Requirement already satisfied: tqdm in /usr/local/lib/python3.6/dist-packages (from kaggle) (4.28.1)
Requirement already satisfied: python-slugify in /usr/local/lib/python3.6/dist-packages (from kaggle) (3.0.1)
Requirement already satisfied: chardet<3.1.0,>=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests->kaggle) (3.0.4)
Requirement already satisfied: idna<2.7,>=2.5 in /usr/local/lib/python3.6/dist-packages (from requests->kaggle) (2.6)
Requirement already satisfied: text-unidecode==1.2 in /usr/local/lib/python3.6/dist-packages (from python-slugify->kaggle) (1.2)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{}upload the credentials of the kaggle account}
        \PY{k+kn}{from} \PY{n+nn}{google}\PY{n+nn}{.}\PY{n+nn}{colab} \PY{k}{import} \PY{n}{files}
        \PY{n}{files}\PY{o}{.}\PY{n}{upload}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{}before importing the dataset we want to use this code}
        \PY{c+c1}{\PYZsh{} The Kaggle API client expects this file to be in \PYZti{}/.kaggle,}
        \PY{o}{!}mkdir \PYZhy{}p \PYZti{}/.kaggle
        \PY{o}{!}cp kaggle.json \PYZti{}/.kaggle/
        
        \PY{c+c1}{\PYZsh{} This permissions change avoids a warning on Kaggle tool startup.}
        \PY{o}{!}chmod \PY{l+m}{600} \PYZti{}/.kaggle/kaggle.json
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{o}{!}ls
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{}import the Amazon fine food review dataset from kaggle}
        \PY{o}{!}kaggle datasets download \PYZhy{}d snap/amazon\PYZhy{}fine\PYZhy{}food\PYZhy{}reviews \PYZhy{}\PYZhy{}force
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{o}{!}unzip amazon\PYZhy{}fine\PYZhy{}food\PYZhy{}reviews.zip
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{c+c1}{\PYZsh{} using SQLite Table to read data.}
         \PY{n}{con} \PY{o}{=} \PY{n}{sqlite3}\PY{o}{.}\PY{n}{connect}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{database.sqlite}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} 
         
         \PY{c+c1}{\PYZsh{} filtering only positive and negative reviews i.e. }
         \PY{c+c1}{\PYZsh{} not taking into consideration those reviews with Score=3}
         \PY{c+c1}{\PYZsh{} SELECT * FROM Reviews WHERE Score != 3 LIMIT 500000, will give top 500000 data points}
         \PY{c+c1}{\PYZsh{} you can change the number to any other number based on your computing power}
         
         \PY{c+c1}{\PYZsh{} filtered\PYZus{}data = pd.read\PYZus{}sql\PYZus{}query(\PYZdq{}\PYZdq{}\PYZdq{} SELECT * FROM Reviews WHERE Score != 3 LIMIT 500000\PYZdq{}\PYZdq{}\PYZdq{}, con) }
         \PY{c+c1}{\PYZsh{} for tsne assignment you can take 5k data points}
         
         \PY{n}{filtered\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{l+s+s2}{ SELECT * FROM Reviews WHERE Score != 3 LIMIT 100000}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{con}\PY{p}{)} 
         
         \PY{c+c1}{\PYZsh{} Give reviews with Score\PYZgt{}3 a positive rating(1), and reviews with a score\PYZlt{}3 a negative rating(0).}
         \PY{k}{def} \PY{n+nf}{partition}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{:}
             \PY{k}{if} \PY{n}{x} \PY{o}{\PYZlt{}} \PY{l+m+mi}{3}\PY{p}{:}
                 \PY{k}{return} \PY{l+m+mi}{0}
             \PY{k}{return} \PY{l+m+mi}{1}
         
         \PY{c+c1}{\PYZsh{}changing reviews with score less than 3 to be positive and vice\PYZhy{}versa}
         \PY{n}{actualScore} \PY{o}{=} \PY{n}{filtered\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{positiveNegative} \PY{o}{=} \PY{n}{actualScore}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{partition}\PY{p}{)} 
         \PY{n}{filtered\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{positiveNegative}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of data points in our data}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{filtered\PYZus{}data}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{filtered\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of data points in our data (100000, 10)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:}    Id   ProductId          UserId                      ProfileName  \textbackslash{}
         0   1  B001E4KFG0  A3SGXH7AUHU8GW                       delmartian   
         1   2  B00813GRG4  A1D87F6ZCVE5NK                           dll pa   
         2   3  B000LQOCH0   ABXLMWJIXXAIN  Natalia Corres "Natalia Corres"   
         
            HelpfulnessNumerator  HelpfulnessDenominator  Score        Time  \textbackslash{}
         0                     1                       1      1  1303862400   
         1                     0                       0      0  1346976000   
         2                     1                       1      1  1219017600   
         
                          Summary                                               Text  
         0  Good Quality Dog Food  I have bought several of the Vitality canned d{\ldots}  
         1      Not as Advertised  Product arrived labeled as Jumbo Salted Peanut{\ldots}  
         2  "Delight" says it all  This is a confection that has been around a fe{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{n}{display} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
        \PY{l+s+s2}{SELECT UserId, ProductId, ProfileName, Time, Score, Text, COUNT(*)}
        \PY{l+s+s2}{FROM Reviews}
        \PY{l+s+s2}{GROUP BY UserId}
        \PY{l+s+s2}{HAVING COUNT(*)\PYZgt{}1}
        \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{con}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{display}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{display}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(80668, 7)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:}                UserId   ProductId             ProfileName        Time  Score  \textbackslash{}
         0  \#oc-R115TNMSPFT9I7  B007Y59HVM                 Breyton  1331510400      2   
         1  \#oc-R11D9D7SHXIJB9  B005HG9ET0  Louis E. Emory "hoppy"  1342396800      5   
         2  \#oc-R11DNU2NBKQ23Z  B007Y59HVM        Kim Cieszykowski  1348531200      1   
         3  \#oc-R11O5J5ZVQE25C  B005HG9ET0           Penguin Chick  1346889600      5   
         4  \#oc-R12KPBODL2B5ZD  B007OSBE1U   Christopher P. Presta  1348617600      1   
         
                                                         Text  COUNT(*)  
         0  Overall its just OK when considering the price{\ldots}         2  
         1  My wife has recurring extreme muscle spasms, u{\ldots}         3  
         2  This coffee is horrible and unfortunately not {\ldots}         2  
         3  This will be the bottle that you grab from the{\ldots}         3  
         4  I didnt like this coffee. Instead of telling y{\ldots}         2  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{display}\PY{p}{[}\PY{n}{display}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{UserId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{==}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AZY10LLTJ71NX}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}59}]:}               UserId   ProductId                      ProfileName        Time  \textbackslash{}
         80638  AZY10LLTJ71NX  B006P7E5ZI  undertheshrine "undertheshrine"  1334707200   
         
                Score                                               Text  COUNT(*)  
         80638      5  I was recommended to try green tea extract to {\ldots}         5  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{display}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{COUNT(*)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}60}]:} 393063
\end{Verbatim}
            
    \section{{[}2{]} Exploratory Data
Analysis}\label{exploratory-data-analysis}

    \subsection{{[}2.1{]} Data Cleaning:
Deduplication}\label{data-cleaning-deduplication}

It is observed (as shown in the table below) that the reviews data had
many duplicate entries. Hence it was necessary to remove duplicates in
order to get unbiased results for the analysis of the data. Following is
an example:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{display}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{SELECT *}
         \PY{l+s+s2}{FROM Reviews}
         \PY{l+s+s2}{WHERE Score != 3 AND UserId=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AR5J8UI46CURR}\PY{l+s+s2}{\PYZdq{}}
         \PY{l+s+s2}{ORDER BY ProductID}
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{con}\PY{p}{)}
         \PY{n}{display}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:}        Id   ProductId         UserId      ProfileName  HelpfulnessNumerator  \textbackslash{}
         0   78445  B000HDL1RQ  AR5J8UI46CURR  Geetha Krishnan                     2   
         1  138317  B000HDOPYC  AR5J8UI46CURR  Geetha Krishnan                     2   
         2  138277  B000HDOPYM  AR5J8UI46CURR  Geetha Krishnan                     2   
         3   73791  B000HDOPZG  AR5J8UI46CURR  Geetha Krishnan                     2   
         4  155049  B000PAQ75C  AR5J8UI46CURR  Geetha Krishnan                     2   
         
            HelpfulnessDenominator  Score        Time  \textbackslash{}
         0                       2      5  1199577600   
         1                       2      5  1199577600   
         2                       2      5  1199577600   
         3                       2      5  1199577600   
         4                       2      5  1199577600   
         
                                      Summary  \textbackslash{}
         0  LOACKER QUADRATINI VANILLA WAFERS   
         1  LOACKER QUADRATINI VANILLA WAFERS   
         2  LOACKER QUADRATINI VANILLA WAFERS   
         3  LOACKER QUADRATINI VANILLA WAFERS   
         4  LOACKER QUADRATINI VANILLA WAFERS   
         
                                                         Text  
         0  DELICIOUS WAFERS. I FIND THAT EUROPEAN WAFERS {\ldots}  
         1  DELICIOUS WAFERS. I FIND THAT EUROPEAN WAFERS {\ldots}  
         2  DELICIOUS WAFERS. I FIND THAT EUROPEAN WAFERS {\ldots}  
         3  DELICIOUS WAFERS. I FIND THAT EUROPEAN WAFERS {\ldots}  
         4  DELICIOUS WAFERS. I FIND THAT EUROPEAN WAFERS {\ldots}  
\end{Verbatim}
            
    As it can be seen above that same user has multiple reviews with same
values for HelpfulnessNumerator, HelpfulnessDenominator, Score, Time,
Summary and Text and on doing analysis it was found that
ProductId=B000HDOPZG was Loacker Quadratini Vanilla Wafer Cookies,
8.82-Ounce Packages (Pack of 8) ProductId=B000HDL1RQ was Loacker
Quadratini Lemon Wafer Cookies, 8.82-Ounce Packages (Pack of 8) and so
on

It was inferred after analysis that reviews with same parameters other
than ProductId belonged to the same product just having different
flavour or quantity. Hence in order to reduce redundancy it was decided
to eliminate the rows having same parameters.

The method used for the same was that we first sort the data according
to ProductId and then just keep the first similar product review and
delelte the others. for eg. in the above just the review for
ProductId=B000HDL1RQ remains. This method ensures that there is only one
representative for each product and deduplication without sorting would
lead to possibility of different representatives still existing for the
same product.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{}Sorting data according to ProductId in ascending order}
        \PY{n}{sorted\PYZus{}data}\PY{o}{=}\PY{n}{filtered\PYZus{}data}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ProductId}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quicksort}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{na\PYZus{}position}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{c+c1}{\PYZsh{}Deduplication of entries}
         \PY{n}{final}\PY{o}{=}\PY{n}{sorted\PYZus{}data}\PY{o}{.}\PY{n}{drop\PYZus{}duplicates}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{UserId}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ProfileName}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Time}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{keep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{first}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
         \PY{n}{final}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:} (87775, 10)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{c+c1}{\PYZsh{}Checking to see how much \PYZpc{} of data still remains}
         \PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{size}\PY{o}{*}\PY{l+m+mf}{1.0}\PY{p}{)}\PY{o}{/}\PY{p}{(}\PY{n}{filtered\PYZus{}data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{size}\PY{o}{*}\PY{l+m+mf}{1.0}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:} 87.775
\end{Verbatim}
            
    Observation:- It was also seen that in two rows given below the value of
HelpfulnessNumerator is greater than HelpfulnessDenominator which is not
practically possible hence these two rows too are removed from
calcualtions

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{display}\PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}sql\PYZus{}query}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+s2}{SELECT *}
         \PY{l+s+s2}{FROM Reviews}
         \PY{l+s+s2}{WHERE Score != 3 AND Id=44737 OR Id=64422}
         \PY{l+s+s2}{ORDER BY ProductID}
         \PY{l+s+s2}{\PYZdq{}\PYZdq{}\PYZdq{}}\PY{p}{,} \PY{n}{con}\PY{p}{)}
         
         \PY{n}{display}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}65}]:}       Id   ProductId          UserId              ProfileName  \textbackslash{}
         0  64422  B000MIDROQ  A161DK06JJMCYF  J. E. Stephens "Jeanne"   
         1  44737  B001EQ55RW  A2V0I904FH7ABY                      Ram   
         
            HelpfulnessNumerator  HelpfulnessDenominator  Score        Time  \textbackslash{}
         0                     3                       1      5  1224892800   
         1                     3                       2      4  1212883200   
         
                                                 Summary  \textbackslash{}
         0             Bought This for My Son at College   
         1  Pure cocoa taste with crunchy almonds inside   
         
                                                         Text  
         0  My son loves spaghetti so I didn't hesitate or{\ldots}  
         1  It was almost a 'love at first bite' - the per{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{n}{final}\PY{o}{=}\PY{n}{final}\PY{p}{[}\PY{n}{final}\PY{o}{.}\PY{n}{HelpfulnessNumerator}\PY{o}{\PYZlt{}}\PY{o}{=}\PY{n}{final}\PY{o}{.}\PY{n}{HelpfulnessDenominator}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{}Before starting the next phase of preprocessing lets see the number of entries left}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{final}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}How many positive and negative reviews are present in our dataset?}
         \PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(87773, 10)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}67}]:} 1    73592
         0    14181
         Name: Score, dtype: int64
\end{Verbatim}
            
    \section{{[}3{]} Preprocessing}\label{preprocessing}

    \subsection{{[}3.1{]}. Preprocessing Review
Text}\label{preprocessing-review-text}

Now that we have finished deduplication our data requires some
preprocessing before we go on further with analysis and making the
prediction model.

Hence in the Preprocessing phase we do the following in the order
below:-

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Begin by removing the html tags
\item
  Remove any punctuations or limited set of special characters like , or
  . or \# etc.
\item
  Check if the word is made up of english letters and is not
  alpha-numeric
\item
  Check to see if the length of the word is greater than 2 (as it was
  researched that there is no adjective in 2-letters)
\item
  Convert the word to lowercase
\item
  Remove Stopwords
\item
  Finally Snowball Stemming the word (it was obsereved to be better than
  Porter Stemming)
\end{enumerate}

After which we collect the words used to describe positive and negative
reviews

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{} https://gist.github.com/sebleier/554280}
        \PY{c+c1}{\PYZsh{} we are removing the words from the stop words list: \PYZsq{}no\PYZsq{}, \PYZsq{}nor\PYZsq{}, \PYZsq{}not\PYZsq{}}
        \PY{c+c1}{\PYZsh{} \PYZlt{}br /\PYZgt{}\PYZlt{}br /\PYZgt{} ==\PYZgt{} after the above steps, we are getting \PYZdq{}br br\PYZdq{}}
        \PY{c+c1}{\PYZsh{} we are including them into stop words list}
        \PY{c+c1}{\PYZsh{} instead of \PYZlt{}br /\PYZgt{} if we have \PYZlt{}br/\PYZgt{} these tags would have revmoved in the 1st step}
        
        \PY{n}{stopwords}\PY{o}{=} \PY{n+nb}{set}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{br}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{the}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{i}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{me}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{my}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{myself}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{we}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{our}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ours}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ourselves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{you}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{you}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{re}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{you}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{you}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ll}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{you}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{your}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yours}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yourself}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yourselves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{he}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{him}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{his}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{himself}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{she}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{she}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{her}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hers}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{herself}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{it}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{it}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{its}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{itself}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{they}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{them}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{their}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{theirs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{themselves}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{what}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{which}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{who}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{whom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{this}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{that}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{that}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ll}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{these}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{those}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{am}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{is}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{are}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{was}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{were}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{be}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{been}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{being}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{have}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{has}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{had}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{having}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{do}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{does}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{did}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{doing}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{a}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{an}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{the}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{and}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{but}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{if}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{or}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{because}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{as}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{until}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{while}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{of}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{at}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{by}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{for}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{with}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{about}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{against}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{between}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{into}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{through}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{during}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{before}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{after}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{above}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{below}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{to}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{from}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{up}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{down}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{in}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{out}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{on}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{off}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{over}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{under}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{again}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{further}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{then}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{once}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{here}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{there}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{when}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{where}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{why}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{how}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{any}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{each}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{few}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{more}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{most}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{other}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{some}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{such}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{only}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{own}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{same}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{so}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{than}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{too}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{very}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{can}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{will}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{just}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{don}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{don}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{should}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{should}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{now}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{d}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ll}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{re}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ve}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ain}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aren}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{aren}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{couldn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{couldn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{didn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{didn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{doesn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{doesn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hadn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hadn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{hasn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hasn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{haven}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{haven}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{isn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{isn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mightn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mightn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mustn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PYZbs{}
                    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{mustn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{needn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{needn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shan}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shan}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{shouldn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{shouldn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wasn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wasn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weren}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{weren}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PYZbs{}
                    \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{won}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{won}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wouldn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wouldn}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{} https://stackoverflow.com/a/47091490/4084039}
        \PY{c+c1}{\PYZsh{} Method will replace Contracted words to normal words.}
        \PY{k+kn}{import} \PY{n+nn}{re}
        
        \PY{k}{def} \PY{n+nf}{decontracted}\PY{p}{(}\PY{n}{phrase}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{} specific}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{won}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{will not}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{can}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{can not}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
        
            \PY{c+c1}{\PYZsh{} general}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{n}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ not}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{re}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ are}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{s}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ is}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ would}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ll}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ will}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ not}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ have}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{n}{phrase} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{m}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ am}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{phrase}\PY{p}{)}
            \PY{k}{return} \PY{n}{phrase}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{} Combining all the above stundents }
         \PY{k+kn}{from} \PY{n+nn}{bs4} \PY{k}{import} \PY{n}{BeautifulSoup}
         \PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k}{import} \PY{n}{tqdm}
         
         \PY{n}{preprocessed\PYZus{}reviews} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} tqdm is for printing the status bar}
         \PY{k}{for} \PY{n}{sentance} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{:}
             \PY{n}{sentance} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{http}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{S+}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sentance}\PY{p}{)}
             \PY{n}{sentance} \PY{o}{=} \PY{n}{BeautifulSoup}\PY{p}{(}\PY{n}{sentance}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lxml}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}text}\PY{p}{(}\PY{p}{)}
             \PY{n}{sentance} \PY{o}{=} \PY{n}{decontracted}\PY{p}{(}\PY{n}{sentance}\PY{p}{)}
             \PY{n}{sentance} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{S*}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{S*}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{sentance}\PY{p}{)}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}
             \PY{n}{sentance} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}A\PYZhy{}Za\PYZhy{}z]+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sentance}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} https://gist.github.com/sebleier/554280}
             \PY{n}{sentance} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{e}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{e} \PY{o+ow}{in} \PY{n}{sentance}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{e}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{stopwords}\PY{p}{)}
             \PY{n}{preprocessed\PYZus{}reviews}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{sentance}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
100\%|██████████| 87773/87773 [00:38<00:00, 2302.57it/s]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{}Printing one random review:}
         \PY{n}{preprocessed\PYZus{}reviews}\PY{p}{[}\PY{l+m+mi}{2134}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}71}]:} 'strange taste kind like relish jelly not good toast really good ham cheese melt'
\end{Verbatim}
            
    \subsection{{[}3.2{]}. Preprocessing Review
summary}\label{preprocessing-review-summary}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{c+c1}{\PYZsh{}Sincw URL is very less in the summary so I am directly applying all the stundants at a time.}
         
         \PY{k+kn}{from} \PY{n+nn}{tqdm} \PY{k}{import} \PY{n}{tqdm}
         \PY{n}{preprocessed\PYZus{}Summary} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{c+c1}{\PYZsh{} tqdm is for printing the status bar}
         \PY{k}{for} \PY{n}{Summary} \PY{o+ow}{in} \PY{n}{tqdm}\PY{p}{(}\PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Summary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{)}\PY{p}{:}
             \PY{n}{Summary} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+sa}{r}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{http}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{S+}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{Summary}\PY{p}{)}
             \PY{n}{Summary} \PY{o}{=} \PY{n}{BeautifulSoup}\PY{p}{(}\PY{n}{Summary}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lxml}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{get\PYZus{}text}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}Summary = remove\PYZus{}tags(Summary)}
             \PY{n}{Summary} \PY{o}{=} \PY{n}{decontracted}\PY{p}{(}\PY{n}{Summary}\PY{p}{)}
             \PY{n}{Summary} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{S*}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZbs{}}\PY{l+s+s2}{S*}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{Summary}\PY{p}{)}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}
             \PY{n}{Summary} \PY{o}{=} \PY{n}{re}\PY{o}{.}\PY{n}{sub}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[\PYZca{}A\PYZhy{}Za\PYZhy{}z]+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{Summary}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} https://gist.github.com/sebleier/554280}
             \PY{n}{Summary} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{e}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{k}{for} \PY{n}{e} \PY{o+ow}{in} \PY{n}{Summary}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)} \PY{k}{if} \PY{n}{e}\PY{o}{.}\PY{n}{lower}\PY{p}{(}\PY{p}{)} \PY{o+ow}{not} \PY{o+ow}{in} \PY{n}{stopwords}\PY{p}{)}
             \PY{n}{preprocessed\PYZus{}Summary}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{Summary}\PY{o}{.}\PY{n}{strip}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
100\%|██████████| 87773/87773 [00:27<00:00, 3247.28it/s]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{}printing one random summary:}
         \PY{n}{preprocessed\PYZus{}Summary}\PY{p}{[}\PY{l+m+mi}{24323}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}73}]:} 'home owner'
\end{Verbatim}
            
    \section{{[}4{]} Feature Engineering}\label{feature-engineering}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{}Merging the Review text and review summary together.}
        
        \PY{n}{final}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Clean\PYZus{}Text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}\PY{n}{preprocessed\PYZus{}reviews}
        \PY{n}{final}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Clean\PYZus{}Summary}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}\PY{n}{preprocessed\PYZus{}Summary}
        \PY{c+c1}{\PYZsh{} Combining them together in Final\PYZus{}Text Field.}
        \PY{n}{final}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Final\PYZus{}Text}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=}\PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Clean\PYZus{}Text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{+}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ }\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Clean\PYZus{}Summary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{values}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{final}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:}           Id   ProductId          UserId        ProfileName  \textbackslash{}
         22620  24750  2734888454  A13ISQV0U9GZIC          Sandikaye   
         22621  24751  2734888454  A1C298ITT645B6  Hugh G. Pritchard   
         70677  76870  B00002N8SM  A19Q006CSFT011           Arlielle   
         70676  76869  B00002N8SM  A1FYH4S02BW7FN           wonderer   
         70675  76868  B00002N8SM   AUE8TB5VHS6ZV      eyeofthestorm   
         
                HelpfulnessNumerator  HelpfulnessDenominator  Score        Time  \textbackslash{}
         22620                     1                       1      0  1192060800   
         22621                     0                       0      1  1195948800   
         70677                     0                       0      0  1288396800   
         70676                     0                       0      0  1290038400   
         70675                     0                       0      0  1306972800   
         
                                                Summary  \textbackslash{}
         22620                            made in china   
         22621                        Dog Lover Delites   
         70677                  only one fruitfly stuck   
         70676  Doesn't work!! Don't waste your money!!   
         70675                            A big rip off   
         
                                                             Text  \textbackslash{}
         22620  My dogs loves this chicken but its a product f{\ldots}   
         22621  Our dogs just love them.  I saw them in a pet {\ldots}   
         70677  I had an infestation of fruitflies, they were {\ldots}   
         70676  Worst product I have gotten in long time. Woul{\ldots}   
         70675  I wish I'd read the reviews before making this{\ldots}   
         
                                                       Clean\_Text  \textbackslash{}
         22620  dogs loves chicken product china wont buying a{\ldots}   
         22621  dogs love saw pet store tag attached regarding{\ldots}   
         70677  infestation fruitflies literally everywhere fl{\ldots}   
         70676  worst product gotten long time would rate no s{\ldots}   
         70675  wish would read reviews making purchase basica{\ldots}   
         
                           Clean\_Summary  \textbackslash{}
         22620                made china   
         22621         dog lover delites   
         70677        one fruitfly stuck   
         70676  not work not waste money   
         70675                   big rip   
         
                                                       Final\_Text  
         22620  dogs loves chicken product china wont buying a{\ldots}  
         22621  dogs love saw pet store tag attached regarding{\ldots}  
         70677  infestation fruitflies literally everywhere fl{\ldots}  
         70676  worst product gotten long time would rate no s{\ldots}  
         70675  wish would read reviews making purchase basica{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{c+c1}{\PYZsh{}printing one data from final text column}
         \PY{n}{final}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{2134}\PY{p}{]}\PY{o}{.}\PY{n}{Final\PYZus{}Text}                
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}76}]:} 'strange taste kind like relish jelly not good toast really good ham cheese melt strange good'
\end{Verbatim}
            
    \section{{[}5{]} Spliting into Train and
test}\label{spliting-into-train-and-test}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{c+c1}{\PYZsh{} Some more imports}
         \PY{o}{!}pip install \PYZhy{}U scikit\PYZhy{}learn
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{naive\PYZus{}bayes} \PY{k}{import} \PY{n}{MultinomialNB}  
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
         \PY{k+kn}{from} \PY{n+nn}{collections} \PY{k}{import} \PY{n}{Counter}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}
         \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{model\PYZus{}selection}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Requirement already up-to-date: scikit-learn in /usr/local/lib/python3.6/dist-packages (0.20.3)
Requirement already satisfied, skipping upgrade: numpy>=1.8.2 in /usr/local/lib/python3.6/dist-packages (from scikit-learn) (1.14.6)
Requirement already satisfied, skipping upgrade: scipy>=0.13.3 in /usr/local/lib/python3.6/dist-packages (from scikit-learn) (1.1.0)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{c+c1}{\PYZsh{}Keeping the Final\PYZus{}Data in a temp variable}
         \PY{n}{temp} \PY{o}{=} \PY{n}{final}
         \PY{n}{temp}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{2134}\PY{p}{]}\PY{o}{.}\PY{n}{Final\PYZus{}Text}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}77}]:} 'strange taste kind like relish jelly not good toast really good ham cheese melt strange good'
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{}Use to revert back the Final\PYZus{}Data dataset}
        \PY{n}{final} \PY{o}{=} \PY{n}{temp}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{final}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}78}]:}           Id   ProductId          UserId        ProfileName  \textbackslash{}
         22620  24750  2734888454  A13ISQV0U9GZIC          Sandikaye   
         22621  24751  2734888454  A1C298ITT645B6  Hugh G. Pritchard   
         70677  76870  B00002N8SM  A19Q006CSFT011           Arlielle   
         70676  76869  B00002N8SM  A1FYH4S02BW7FN           wonderer   
         70675  76868  B00002N8SM   AUE8TB5VHS6ZV      eyeofthestorm   
         
                HelpfulnessNumerator  HelpfulnessDenominator  Score        Time  \textbackslash{}
         22620                     1                       1      0  1192060800   
         22621                     0                       0      1  1195948800   
         70677                     0                       0      0  1288396800   
         70676                     0                       0      0  1290038400   
         70675                     0                       0      0  1306972800   
         
                                                Summary  \textbackslash{}
         22620                            made in china   
         22621                        Dog Lover Delites   
         70677                  only one fruitfly stuck   
         70676  Doesn't work!! Don't waste your money!!   
         70675                            A big rip off   
         
                                                             Text  \textbackslash{}
         22620  My dogs loves this chicken but its a product f{\ldots}   
         22621  Our dogs just love them.  I saw them in a pet {\ldots}   
         70677  I had an infestation of fruitflies, they were {\ldots}   
         70676  Worst product I have gotten in long time. Woul{\ldots}   
         70675  I wish I'd read the reviews before making this{\ldots}   
         
                                                       Clean\_Text  \textbackslash{}
         22620  dogs loves chicken product china wont buying a{\ldots}   
         22621  dogs love saw pet store tag attached regarding{\ldots}   
         70677  infestation fruitflies literally everywhere fl{\ldots}   
         70676  worst product gotten long time would rate no s{\ldots}   
         70675  wish would read reviews making purchase basica{\ldots}   
         
                           Clean\_Summary  \textbackslash{}
         22620                made china   
         22621         dog lover delites   
         70677        one fruitfly stuck   
         70676  not work not waste money   
         70675                   big rip   
         
                                                       Final\_Text  
         22620  dogs loves chicken product china wont buying a{\ldots}  
         22621  dogs love saw pet store tag attached regarding{\ldots}  
         70677  infestation fruitflies literally everywhere fl{\ldots}  
         70676  worst product gotten long time would rate no s{\ldots}  
         70675  wish would read reviews making purchase basica{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{} Sorting data based on time}
        \PY{c+c1}{\PYZsh{}final\PYZus{}Data[\PYZdq{}Time\PYZdq{}] = pd.to\PYZus{}datetime(final\PYZus{}Data[\PYZdq{}Time\PYZdq{}], unit = \PYZdq{}s\PYZdq{})}
        \PY{c+c1}{\PYZsh{}final\PYZus{}Data = final\PYZus{}Data.sort\PYZus{}values(by = \PYZdq{}Time\PYZdq{})}
        
        \PY{n}{final} \PY{o}{=} \PY{n}{final}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{kind}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{quicksort}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{na\PYZus{}position}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{last}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{final}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}40}]:}           Id   ProductId          UserId  \textbackslash{}
         70688  76882  B00002N8SM  A32DW342WBJ6BX   
         1146    1245  B00002Z754  A29Z5PI9BW2PU3   
         1145    1244  B00002Z754  A3B8RCEI0FXFI6   
         28086  30629  B00008RCMI  A19E94CF5O1LY7   
         28087  30630  B00008RCMI  A284C7M23F0APC   
         61299  66610  B0000SY9U4  A3EEDHNHI4WNSH   
         38740  42069  B0000EIEQU  A1YMJX4YWCE6P4   
         38889  42227  B0000A0BS8  A1IU7S4HCK1XK0   
         38888  42226  B0000A0BS8  A23GFTVIETX7DS   
         10992  11991  B0000T15M8  A2928LJN5IISB4   
         
                                          ProfileName  HelpfulnessNumerator  \textbackslash{}
         70688                            Buttersugar                     0   
         1146                                  Robbie                     7   
         1145                               B G Chase                    10   
         28086                          Andrew Arnold                     0   
         28087                             A. Mendoza                     0   
         61299                        Joanna J. Young                    23   
         38740  Jim Carson "http://www.jimcarson.com"                    12   
         38889                         Joanna Daneman                     5   
         38888                  Debbie Lee Wesselmann                     5   
         10992                                chatchi                     5   
         
                HelpfulnessDenominator  Score        Time  \textbackslash{}
         70688                       0      1   948672000   
         1146                        7      1   961718400   
         1145                       10      1   962236800   
         28086                       0      1  1067040000   
         28087                       0      1  1067040000   
         61299                      23      1  1067472000   
         38740                      12      1  1067558400   
         38889                       5      1  1067644800   
         38888                       5      1  1067904000   
         10992                       5      1  1067990400   
         
                                                   Summary  \textbackslash{}
         70688                      A sure death for flies   
         1146                                Great Product   
         1145               WOW Make your own 'slickers' !   
         28086  I've chewed this gum many times, but used?   
         28087                    Best sugarless gum ever!   
         61299                                       Yummy   
         38740                           These limes rule!   
         38889                  I gave up on other coffees   
         38888            Five stars if you like Starbucks   
         10992                      The fruits of my labor   
         
                                                             Text  \textbackslash{}
         70688  I bought a few of these after my apartment was{\ldots}   
         1146   This was a really good idea and the final prod{\ldots}   
         1145   I just received my shipment and could hardly w{\ldots}   
         28086  Nothing against the product, but it does bothe{\ldots}   
         28087  I love this stuff. It is sugar-free so it does{\ldots}   
         61299  If you've never tried Kona coffee, Aloha Islan{\ldots}   
         38740  Fresh limes are underappreciated, but a joy to{\ldots}   
         38889  The grocery store has all kinds of \&quot;gourm{\ldots}   
         38888  This blend is one of Starbucks' gentler blends{\ldots}   
         10992  When chatchi's favorite afternoon treat became{\ldots}   
         
                                                       Clean\_Text  \textbackslash{}
         70688  bought apartment infested fruit flies hours tr{\ldots}   
         1146   really good idea final product outstanding use{\ldots}   
         1145   received shipment could hardly wait try produc{\ldots}   
         28086  nothing product bother link top page buy used {\ldots}   
         28087  love stuff sugar free not rot gums tastes good{\ldots}   
         61299  never tried kona coffee aloha island definitel{\ldots}   
         38740  fresh limes underappreciated joy kitchen squir{\ldots}   
         38889  grocery store kinds gourmet coffees laid one t{\ldots}   
         38888  blend one starbucks gentler blends like taste {\ldots}   
         10992  chatchi favorite afternoon treat became myster{\ldots}   
         
                             Clean\_Summary  \textbackslash{}
         70688            sure death flies   
         1146                great product   
         1145           wow make islickers   
         28086  chewed gum many times used   
         28087     best sugarless gum ever   
         61299                       yummy   
         38740                  limes rule   
         38889                gave coffees   
         38888   five stars like starbucks   
         10992                fruits labor   
         
                                                       Final\_Text  
         70688  bought apartment infested fruit flies hours tr{\ldots}  
         1146   really good idea final product outstanding use{\ldots}  
         1145   received shipment could hardly wait try produc{\ldots}  
         28086  nothing product bother link top page buy used {\ldots}  
         28087  love stuff sugar free not rot gums tastes good{\ldots}  
         61299  never tried kona coffee aloha island definitel{\ldots}  
         38740  fresh limes underappreciated joy kitchen squir{\ldots}  
         38889  grocery store kinds gourmet coffees laid one t{\ldots}  
         38888  blend one starbucks gentler blends like taste {\ldots}  
         10992  chatchi favorite afternoon treat became myster{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{final}\PY{o}{.}\PY{n}{tail}\PY{p}{(}\PY{l+m+mi}{60}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}80}]:}            Id   ProductId          UserId  \textbackslash{}
         87501   95241  B00401OZ1U  A1KIL93AY6MFGS   
         63160   68621  B005IOXBY0  A1ORVAUR5C5N8X   
         66057   71787  B007RTR8AC  A2PZM8DT1KGT10   
         41621   45226  B00443Z35G  A3G23SMM1E1KPV   
         9513    10404  B005HI55CS  A36ERNIM0TKG3T   
         30235   32932  B001P05K8Q  A3L0B5NBTQ7ZHO   
         96778  105165  B005EF0HZ4  A2A5Z7LC91EFVA   
         96779  105166  B005EF0HZ4  A1JXSMYVHFPWM1   
         32585   35471  B000WSHV1Q  A1YT628H711FN7   
         96263  104607  B000FACFIA  A1TTGEM50SIS2R   
         75382   82028  B0019GZ7Z2   ANSBPV2CZVZ39   
         7451     8135  B0019GVYR2   ACSO5EDO1UMZ5   
         69746   75882  B002W1F6TK   ANSBPV2CZVZ39   
         24496   26772  B004ZY4TK4   A4IL0CLL27Q33   
         86066   93711  B001NZPFB0  A3318V6FJ2KIII   
         75877   82567  B008FXKOI2  A3RKYD8IUC5S0N   
         84914   92421  B007TGDXMK  A1BSGNCHEI1PJI   
         5472     5924  B00523NRVO  A2JDXKFZ0PFHKU   
         38043   41317  B008NDSNAU  A2Z0XFW79HXASE   
         19181   20930  B001L1MKLY  A38XYFHXEUNUW6   
         85745   93367  B007TGDXMU   AAMUNRK134Y5P   
         85744   93366  B007TGDXMU   AGUBQN9M09VQ4   
         85743   93365  B007TGDXMU   A9JMG87TELB6N   
         55730   60463  B003QNJYXM   AYTSBGA5A3UWI   
         55731   60464  B003QNJYXM  A2E2F8WSUB33VE   
         55158   59851  B001EQ5KTK  A3GS4GWPIBV0NT   
         83618   91002  B001E5E470   AGADB4E6N1EDS   
         8731     9564  B001EQ5IPQ   AA2104NO2VE8H   
         78920   85816  B005XGH78E  A2YGWCOC3LM3KH   
         93098  101227  B006N0KV8W  A1OA7ZKRQH98C8   
         42269   45991  B007VQQT1K  A34P4V70RNC2YV   
         76059   82772  B0049K99RW  A1Y73Y4VX3AJMZ   
         25112   27424  B003WEFSAI  A37O0JPLJ8BOXP   
         29158   31794  B0049D7HRS  A3LR9HCV3D96I3   
         87843   95629  B000LKXDXU  A2J3PR6J36UTVH   
         97624  106071  B007JTKEQK  A1DOMJI7GXGPNY   
         14526   15842  B007TJGZ5E  A3UOYYQS5Z47MS   
         14300   15605  B000255OIG   AUINI96NMGXUI   
         14299   15604  B000255OIG  A3SSEJ8IEM4YGW   
         82884   90215  B00866AM2G   ADTOX2JFWWA0B   
         82885   90216  B00866AM2G   AY839W9JQDZM2   
         15069   16426  B007TJGZ54  A29BJSTYH9W3JI   
         43703   47562  B004M0Y8T8  A2QJS6MHTIFSRI   
         13539   14784  B000S859NC  A2H7STZ2URUCOE   
         52220   56723  B0012XBD7I  A32NC2UF34RJQY   
         55100   59787  B002K9BG16  A30A7W9CZ77GFY   
         89213   97089  B004O8KBK8  A1JPKFGGF128X1   
         6548     7178  B004OQLIHK   AKHQMSUORSA91   
         60967   66252  B007OSBGOK   A10QOESY9VJ9K   
         43268   47077  B001C4PKIK  A3IMXYITIO8WHN   
         16026   17512  B0045Z6K50  A3HM6TNYB7FNDL   
         90340   98294  B0002LY6W0  A1BX08Y0GIT5RU   
         76594   83330  B005ZBZLT4   AAMUNRK134Y5P   
         78715   85601  B003ZURM80  A1O6MADFNBRX7H   
         50708   55049  B000IHJEDE  A2DFSA2JXQKVY3   
         76593   83329  B005ZBZLT4  A308RR8J9NJOOZ   
         22401   24518  B0016JJEFG   AO9WE22147CRH   
         56673   61474  B005YVU4A6  A2LU545SISQOJ8   
         37074   40274  B005VOOT52  A2FKFQQPU498JT   
         5259     5703  B009WSNWC4   AMP7K1O84DH1T   
         
                                                     ProfileName  HelpfulnessNumerator  \textbackslash{}
         87501                                      John K. Kirk                     0   
         63160                                        amondigirl                     0   
         66057                    Edwina E. Cowgill "book lover"                     0   
         41621                                       L. E. Scott                     0   
         9513                                   Donald E. Bolton                     0   
         30235                                             Julie                     0   
         96778                                    Gretchen Casey                     0   
         96779                                    marsha m beers                     0   
         32585                                      Laura Tomevi                     0   
         96263                                              Abby                     0   
         75382                               zena3546 "zena3546"                     0   
         7451                                       SeekingBodhi                     0   
         69746                               zena3546 "zena3546"                     0   
         24496                                        D. Brennan                     0   
         86066                                         T. Dennis                     0   
         75877                                     Foureyedsnail                     0   
         84914                    Kelly Bowser "Runs W Scissors"                     0   
         5472                                   James W. Shondel                     0   
         38043                         Kelby Scandrett "Kaiahso"                     0   
         19181                                         bleaufire                     0   
         85745                                         Tony Schy                     0   
         85744                                     Inger Jackson                     0   
         85743                                    Ludmila Newman                     0   
         55730                                         Imran Ali                     0   
         55731                                  Maria A. Alfonzo                     0   
         55158                            R. Chester "ricki1966"                     0   
         83618                    L. A. Stephenson "Mom of four"                     0   
         8731                                Lakshminarayan Iyer                     0   
         78920                                Luke R. McAllister                     0   
         93098                                           M Mills                     0   
         42269                                           S. Guss                     0   
         76059                                     Rispir Chrone                     0   
         25112                                      Texaschick59                     0   
         29158                                      Gypsy Healer                     0   
         87843                                             Joyce                     0   
         97624                                             Jyouk                     0   
         14526                            David A. Levin "DaveL"                     0   
         14300                                           Kkrys23                     0   
         14299                                           Seagaul                     0   
         82884                                        Arnos Vale                     0   
         82885                                          Daniella                     0   
         15069                                             Harry                     0   
         43703                                           Georgie                     0   
         13539                 Christopher Whedon "the odd bead"                     0   
         52220                                   D. Pagliassotti                     0   
         55100                    Cecelia Thomas "Lady Kinrowan"                     0   
         89213                                            MTNick                     0   
         6548                                           Pen Name                     0   
         60967                                              Gina                     0   
         43268                                 Thomas R. Jackson                     0   
         16026                                         C. Furman                     0   
         90340  L. Nguyen "Always on the lookout for a good d{\ldots}                     0   
         76594                                         Tony Schy                     0   
         78715                                       Denise Lake                     0   
         50708                                            C-Rush                     0   
         76593                                              Josh                     0   
         22401                                      Arvind Rajan                     0   
         56673                                             Kelly                     0   
         37074                                                cc                     0   
         5259                                               ESTY                     0   
         
                HelpfulnessDenominator  Score        Time  \textbackslash{}
         87501                       0      1  1351209600   
         63160                       0      1  1351209600   
         66057                       0      1  1351209600   
         41621                       0      1  1351209600   
         9513                        0      1  1351209600   
         30235                       0      1  1351209600   
         96778                       0      1  1351209600   
         96779                       0      0  1351209600   
         32585                       0      1  1351209600   
         96263                       0      1  1351209600   
         75382                       0      1  1351209600   
         7451                        0      0  1351209600   
         69746                       0      0  1351209600   
         24496                       0      0  1351209600   
         86066                       0      1  1351209600   
         75877                       0      1  1351209600   
         84914                       0      1  1351209600   
         5472                        0      1  1351209600   
         38043                       0      1  1351209600   
         19181                       0      1  1351209600   
         85745                       0      1  1351209600   
         85744                       0      0  1351209600   
         85743                       0      1  1351209600   
         55730                       0      1  1351209600   
         55731                       0      1  1351209600   
         55158                       0      1  1351209600   
         83618                       0      1  1351209600   
         8731                        0      0  1351209600   
         78920                       0      1  1351209600   
         93098                       0      1  1351209600   
         42269                       0      1  1351209600   
         76059                       0      1  1351209600   
         25112                       0      1  1351209600   
         29158                       0      1  1351209600   
         87843                       0      1  1351209600   
         97624                       0      1  1351209600   
         14526                       0      1  1351209600   
         14300                       0      1  1351209600   
         14299                       0      1  1351209600   
         82884                       0      1  1351209600   
         82885                       0      1  1351209600   
         15069                       0      1  1351209600   
         43703                       0      1  1351209600   
         13539                       0      1  1351209600   
         52220                       0      1  1351209600   
         55100                       0      1  1351209600   
         89213                       0      1  1351209600   
         6548                        0      1  1351209600   
         60967                       0      1  1351209600   
         43268                       0      1  1351209600   
         16026                       0      1  1351209600   
         90340                       0      1  1351209600   
         76594                       0      1  1351209600   
         78715                       0      1  1351209600   
         50708                       0      1  1351209600   
         76593                       0      1  1351209600   
         22401                       0      0  1351209600   
         56673                       0      1  1351209600   
         37074                       0      1  1351209600   
         5259                        0      1  1351209600   
         
                                                          Summary  \textbackslash{}
         87501                                 Metromint or Bust!   
         63160                                           WOW{\ldots}   
         66057                                   Fabulous Shampoo   
         41621                             Great Swedish Pastries   
         9513                          Hidden Springs Maple syrup   
         30235                       Great results but they stink   
         96778                                    Gluten Free Kid   
         96779                                       Disappointed   
         32585                                        Great Treat   
         96263                         Licorice Scottie Dogs, Red   
         75382                                      Great product   
         7451                                           NEWSFLASH   
         69746                                    terrible treats   
         24496                                       Buyer beware   
         86066            My dog enjoys it and it helps her hips.   
         75877                                   Tasty and works!   
         84914                             Very Nice Medium Roast   
         5472                                    The perfect pop!   
         38043                                                Yum   
         19181                                     Yummy \& Subtle   
         85745                                       Very pleased   
         85744                                Not what I expected   
         85743                             Best coffee I ever had   
         55730                               A God Sent Remedy!!!   
         55731                                           Excelent   
         55158                                      Love this tea   
         83618                              Help for a Lousy Cook   
         8731                              Extremely dissapointed   
         78920               Great flavor - spicy but not too hot   
         93098                                      no complaints   
         42269                                    Great Irish Tea   
         76059                              Nice traditional chai   
         25112                                          Drink mix   
         29158                                          Delicious   
         87843              Michael Seasons Unsalted Potato Chips   
         97624  Ain't no coconut water better than Sun Tropics{\ldots}   
         14526                                     Morning Coffee   
         14300                                   Love this faucet   
         14299                                      Dogs love it.   
         82884                                           Love it.   
         82885                                        I love this   
         15069                                       super coffee   
         43703                              Sleeping a lot better   
         13539                                          GREAT TEA   
         52220                                 Great for HS lunch   
         55100  Butler's chocolate is the real deal direct fro{\ldots}   
         89213                                  Yummy and Healthy   
         6548                                          Delicious!   
         60967                                 So many varieties!   
         43268                                        Great food!   
         16026          Full- bodied without a bitter after-taste   
         90340                  The BEST fig spread on the market   
         76594                           Product is good, but{\ldots}   
         78715                       5 Star Tea at a super price!   
         50708                                           Not bad.   
         76593                                   One of the best!   
         22401                                    bad tasting tea   
         56673                                             Chike!   
         37074                                   chocolate heaven   
         5259                                           DELICIOUS   
         
                                                             Text  \textbackslash{}
         87501  Chilled Oragemint is a classic refreshment for{\ldots}   
         63160  This chocolate is amazing..I love the taste an{\ldots}   
         66057  The name says it all- Clear Scalp and Hair  - {\ldots}   
         41621  Svenhard's varity pack pastries are great.  In{\ldots}   
         9513   This is one of the very finest maple syrups I {\ldots}   
         30235  We originally purchased these chews from our v{\ldots}   
         96778  We LOVE Lucy's cookies!  The Maple Bliss are w{\ldots}   
         96779  I have not been able to find the Maple flavor {\ldots}   
         32585  My cats love these. They are very hard to find{\ldots}   
         96263  I love the Gimbals Red Licorice Scottie dogs I{\ldots}   
         75382  This is a wonderful flour to use. low carbs, a{\ldots}   
         7451   I just called Bob's Red Mill customer service {\ldots}   
         69746  My dogs love them but they are loaded with jun{\ldots}   
         24496  Nespresso makes GREAT coffee and GREAT machine{\ldots}   
         86066  My dog was diagnosed with hip dysplasia as a 6{\ldots}   
         75877  First off, my cat HATES regular Greenies (the {\ldots}   
         84914  This coffee has the best aroma!  Great medium {\ldots}   
         5472   These lollipops are are well done, look exactl{\ldots}   
         38043  Yum, Yum, Yum, Yum{\ldots}  (Munch, munch).  Yum!  {\ldots}   
         19181  Just made my first pot of this wonderful coffe{\ldots}   
         85745  Good price, good quality with convenience.  Fu{\ldots}   
         85744  First of all the "k-cups" were weird and the t{\ldots}   
         85743  This is the best coffee I have ever had. I hav{\ldots}   
         55730  I love this stuff! It's a God sent Remedy for {\ldots}   
         55731  Good price, flavor, fast delivery And good pre{\ldots}   
         55158  This is a favorite of mine for using over ice{\ldots}   
         83618  I'm a lousy cook and I know it.  However, when{\ldots}   
         8731   Hi,<br />I am very disappointed with the past {\ldots}   
         78920  I got some of this from a low sodium foods web{\ldots}   
         93098  I'm a huge fan of Jack Daniel's jelly, <a href{\ldots}   
         42269  We recently returned from a wonderful three we{\ldots}   
         76059  I got hooked on this chai when I decided to gi{\ldots}   
         25112  We love this drink mix it taste delicious and {\ldots}   
         29158  Individually packaged assorted rice crackers a{\ldots}   
         87843  These are the best chips ever!  They are unsal{\ldots}   
         97624  This is like young coconut in a can! It tastes{\ldots}   
         14526  Great coffee at a good price. I'm a subscripti{\ldots}   
         14300  Love this faucet.  My husband had installed th{\ldots}   
         14299  This is the "all gone" treat after dinner.  It{\ldots}   
         82884  I love this but think its a little to expensiv{\ldots}   
         82885  It's is in my opinion the best coconut water o{\ldots}   
         15069  Great coffee and so easy to brew.  This coffee{\ldots}   
         43703  Hubby and I (both 63) have been drinking about{\ldots}   
         13539  Rooibos Natural Red tea is something of a pers{\ldots}   
         52220  Great for HS lunch, kid enjoy as a snack also,{\ldots}   
         55100  Nifty hot chocolate discs added to your warm m{\ldots}   
         89213  Loved the cranberry-like flavor and slightly c{\ldots}   
         6548   I have ordered these raisins multiple times.  {\ldots}   
         60967  I love the assortment.  Different countries of{\ldots}   
         43268  I wanted a food for a a dog with skin problems{\ldots}   
         16026  This is my everyday coffee choice{\ldots}a good all{\ldots}   
         90340  This is my go to spread when I serve a cheese {\ldots}   
         76594  I like the product and the price point, but fo{\ldots}   
         78715  This tea is very good and perfect for the pric{\ldots}   
         50708  These are small and very salty. The taste is g{\ldots}   
         76593  I am recently new to the Keurig world.  I've t{\ldots}   
         22401  We drink a lot of tea{\ldots} from all over the wor{\ldots}   
         56673  Just tried the orange and iced coffee this mor{\ldots}   
         37074  Excellent smooth taste. Any one who loves choc{\ldots}   
         5259   Purchased this product at a local store in NY {\ldots}   
         
                                                       Clean\_Text  \textbackslash{}
         87501  chilled oragemint classic refreshment dry scra{\ldots}   
         63160  chocolate amazing love taste smell chocolate f{\ldots}   
         66057  name says clear scalp hair leaves hair clear p{\ldots}   
         41621  svenhard varity pack pastries great individual{\ldots}   
         9513   one finest maple syrups ordered enjoyed bought{\ldots}   
         30235  originally purchased chews veterinarian decide{\ldots}   
         96778  love lucy cookies maple bliss wonderful bad ha{\ldots}   
         96779  not able find maple flavor cookies area anywhe{\ldots}   
         32585  cats love hard find anywhere used available pe{\ldots}   
         96263  love gimbals red licorice scottie dogs purchas{\ldots}   
         75382  wonderful flour use low carbs full nutrients d{\ldots}   
         7451   called bob red mill customer service g search {\ldots}   
         69746  dogs love loaded junk come another country wen{\ldots}   
         24496  nespresso makes great coffee great machines sw{\ldots}   
         86066  dog diagnosed hip dysplasia old puppy vet said{\ldots}   
         75877  first cat hates regular greenies big crunchy o{\ldots}   
         84914  coffee best aroma great medium taste replaced {\ldots}   
         5472   lollipops well done look exactly like picture {\ldots}   
         38043  yum yum yum yum munch munch yum love tastes wo{\ldots}   
         19181  made first pot wonderful coffee simply delish {\ldots}   
         85745  good price good quality convenience fully met {\ldots}   
         85744  first k cups weird taste not thought would not{\ldots}   
         85743  best coffee ever keurig coffee maker several y{\ldots}   
         55730  love stuff god sent remedy hangovers understan{\ldots}   
         55731  good price flavor fast delivery good presentat{\ldots}   
         55158  favorite mine using ice even bought give chris{\ldots}   
         83618  lousy cook know however kids grind little garl{\ldots}   
         8731   hi disappointed past shipment received one coc{\ldots}   
         78920  got low sodium foods website not believe much {\ldots}   
         93098                         huge fan jack daniel jelly   
         42269  recently returned wonderful three week excursi{\ldots}   
         76059  got hooked chai decided give coffee still litt{\ldots}   
         25112  love drink mix taste delicious impossible yo f{\ldots}   
         29158  individually packaged assorted rice crackers r{\ldots}   
         87843  best chips ever unsalted low sodium diet criti{\ldots}   
         97624  like young coconut tastes like young coconut f{\ldots}   
         14526  great coffee good price subscription buyer buy{\ldots}   
         14300  love faucet husband installed one old house cu{\ldots}   
         14299  gone treat dinner treat dogs work run chance l{\ldots}   
         82884  love think little expensive everyday use refre{\ldots}   
         82885  opinion best coconut water especially since no{\ldots}   
         15069  great coffee easy brew coffee great aroma good{\ldots}   
         43703  hubby drinking oz night months found falling d{\ldots}   
         13539  rooibos natural red tea something personal tas{\ldots}   
         52220  great hs lunch kid enjoy snack also buy salted{\ldots}   
         55100  nifty hot chocolate discs added warm milk milk{\ldots}   
         89213  loved cranberry like flavor slightly crunchy t{\ldots}   
         6548   ordered raisins multiple times always great ar{\ldots}   
         60967  love assortment different countries origins fu{\ldots}   
         43268  wanted food dog skin problems skin greatly imp{\ldots}   
         16026  everyday coffee choice good around crowd pleas{\ldots}   
         90340  go spread serve cheese platter goes well soft {\ldots}   
         76594  like product price point flavor strong overpow{\ldots}   
         78715  tea good perfect price not go wrong product mu{\ldots}   
         50708  small salty taste good strong good thing packa{\ldots}   
         76593  recently new keurig world tried handful flavor{\ldots}   
         22401  drink lot tea world far worst tasting tea purc{\ldots}   
         56673  tried orange iced coffee morning really liked {\ldots}   
         37074  excellent smooth taste one loves chocolate enj{\ldots}   
         5259   purchased product local store ny kids love qui{\ldots}   
         
                                                    Clean\_Summary  \textbackslash{}
         87501                                     metromint bust   
         63160                                                wow   
         66057                                   fabulous shampoo   
         41621                             great swedish pastries   
         9513                          hidden springs maple syrup   
         30235                                great results stink   
         96778                                    gluten free kid   
         96779                                       disappointed   
         32585                                        great treat   
         96263                          licorice scottie dogs red   
         75382                                      great product   
         7451                                           newsflash   
         69746                                    terrible treats   
         24496                                       buyer beware   
         86066                              dog enjoys helps hips   
         75877                                        tasty works   
         84914                                  nice medium roast   
         5472                                         perfect pop   
         38043                                                yum   
         19181                                       yummy subtle   
         85745                                            pleased   
         85744                                       not expected   
         85743                                   best coffee ever   
         55730                                    god sent remedy   
         55731                                           excelent   
         55158                                           love tea   
         83618                                    help lousy cook   
         8731                              extremely dissapointed   
         78920                         great flavor spicy not hot   
         93098                                      no complaints   
         42269                                    great irish tea   
         76059                              nice traditional chai   
         25112                                          drink mix   
         29158                                          delicious   
         87843              michael seasons unsalted potato chips   
         97624  ai not no coconut water better sun tropics coc{\ldots}   
         14526                                     morning coffee   
         14300                                        love faucet   
         14299                                          dogs love   
         82884                                               love   
         82885                                               love   
         15069                                       super coffee   
         43703                                sleeping lot better   
         13539                                          great tea   
         52220                                     great hs lunch   
         55100          butler chocolate real deal direct ireland   
         89213                                      yummy healthy   
         6548                                           delicious   
         60967                                     many varieties   
         43268                                         great food   
         16026                   full bodied without bitter taste   
         90340                             best fig spread market   
         76594                                       product good   
         78715                               star tea super price   
         50708                                            not bad   
         76593                                           one best   
         22401                                    bad tasting tea   
         56673                                              chike   
         37074                                   chocolate heaven   
         5259                                           delicious   
         
                                                       Final\_Text  
         87501  chilled oragemint classic refreshment dry scra{\ldots}  
         63160  chocolate amazing love taste smell chocolate f{\ldots}  
         66057  name says clear scalp hair leaves hair clear p{\ldots}  
         41621  svenhard varity pack pastries great individual{\ldots}  
         9513   one finest maple syrups ordered enjoyed bought{\ldots}  
         30235  originally purchased chews veterinarian decide{\ldots}  
         96778  love lucy cookies maple bliss wonderful bad ha{\ldots}  
         96779  not able find maple flavor cookies area anywhe{\ldots}  
         32585  cats love hard find anywhere used available pe{\ldots}  
         96263  love gimbals red licorice scottie dogs purchas{\ldots}  
         75382  wonderful flour use low carbs full nutrients d{\ldots}  
         7451   called bob red mill customer service g search {\ldots}  
         69746  dogs love loaded junk come another country wen{\ldots}  
         24496  nespresso makes great coffee great machines sw{\ldots}  
         86066  dog diagnosed hip dysplasia old puppy vet said{\ldots}  
         75877  first cat hates regular greenies big crunchy o{\ldots}  
         84914  coffee best aroma great medium taste replaced {\ldots}  
         5472   lollipops well done look exactly like picture {\ldots}  
         38043  yum yum yum yum munch munch yum love tastes wo{\ldots}  
         19181  made first pot wonderful coffee simply delish {\ldots}  
         85745  good price good quality convenience fully met {\ldots}  
         85744  first k cups weird taste not thought would not{\ldots}  
         85743  best coffee ever keurig coffee maker several y{\ldots}  
         55730  love stuff god sent remedy hangovers understan{\ldots}  
         55731  good price flavor fast delivery good presentat{\ldots}  
         55158  favorite mine using ice even bought give chris{\ldots}  
         83618  lousy cook know however kids grind little garl{\ldots}  
         8731   hi disappointed past shipment received one coc{\ldots}  
         78920  got low sodium foods website not believe much {\ldots}  
         93098           huge fan jack daniel jelly no complaints  
         42269  recently returned wonderful three week excursi{\ldots}  
         76059  got hooked chai decided give coffee still litt{\ldots}  
         25112  love drink mix taste delicious impossible yo f{\ldots}  
         29158  individually packaged assorted rice crackers r{\ldots}  
         87843  best chips ever unsalted low sodium diet criti{\ldots}  
         97624  like young coconut tastes like young coconut f{\ldots}  
         14526  great coffee good price subscription buyer buy{\ldots}  
         14300  love faucet husband installed one old house cu{\ldots}  
         14299  gone treat dinner treat dogs work run chance l{\ldots}  
         82884  love think little expensive everyday use refre{\ldots}  
         82885  opinion best coconut water especially since no{\ldots}  
         15069  great coffee easy brew coffee great aroma good{\ldots}  
         43703  hubby drinking oz night months found falling d{\ldots}  
         13539  rooibos natural red tea something personal tas{\ldots}  
         52220  great hs lunch kid enjoy snack also buy salted{\ldots}  
         55100  nifty hot chocolate discs added warm milk milk{\ldots}  
         89213  loved cranberry like flavor slightly crunchy t{\ldots}  
         6548   ordered raisins multiple times always great ar{\ldots}  
         60967  love assortment different countries origins fu{\ldots}  
         43268  wanted food dog skin problems skin greatly imp{\ldots}  
         16026  everyday coffee choice good around crowd pleas{\ldots}  
         90340  go spread serve cheese platter goes well soft {\ldots}  
         76594  like product price point flavor strong overpow{\ldots}  
         78715  tea good perfect price not go wrong product mu{\ldots}  
         50708  small salty taste good strong good thing packa{\ldots}  
         76593  recently new keurig world tried handful flavor{\ldots}  
         22401  drink lot tea world far worst tasting tea purc{\ldots}  
         56673  tried orange iced coffee morning really liked {\ldots}  
         37074  excellent smooth taste one loves chocolate enj{\ldots}  
         5259   purchased product local store ny kids love qui{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{c+c1}{\PYZsh{} split the data set into train and test}
        \PY{n}{X\PYZus{}Train}\PY{p}{,} \PY{n}{X\PYZus{}Test}\PY{p}{,} \PY{n}{Y\PYZus{}Train}\PY{p}{,} \PY{n}{Y\PYZus{}Test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{final}\PY{p}{,} \PY{n}{final}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,}\PY{n}{shuffle} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Size of X\PYZus{}Test :}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}Test}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Size of Y\PYZus{}Test :}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{Y\PYZus{}Test}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{=}\PY{l+s+s1}{\PYZsq{}}\PY{o}{*}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Size of X\PYZhy{}Train :}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{X\PYZus{}Train}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Size of Y\PYZus{}Train :}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{Y\PYZus{}Train}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Size of X\_Test : 26332
Size of Y\_Test : 26332
==================================================
Size of X-Train : 61441
Size of Y\_Train : 61441

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{X\PYZus{}Train}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}83}]:}           Id   ProductId          UserId    ProfileName  HelpfulnessNumerator  \textbackslash{}
         70688  76882  B00002N8SM  A32DW342WBJ6BX    Buttersugar                     0   
         1146    1245  B00002Z754  A29Z5PI9BW2PU3         Robbie                     7   
         1145    1244  B00002Z754  A3B8RCEI0FXFI6      B G Chase                    10   
         28086  30629  B00008RCMI  A19E94CF5O1LY7  Andrew Arnold                     0   
         28087  30630  B00008RCMI  A284C7M23F0APC     A. Mendoza                     0   
         
                HelpfulnessDenominator  Score        Time  \textbackslash{}
         70688                       0      1   948672000   
         1146                        7      1   961718400   
         1145                       10      1   962236800   
         28086                       0      1  1067040000   
         28087                       0      1  1067040000   
         
                                                   Summary  \textbackslash{}
         70688                      A sure death for flies   
         1146                                Great Product   
         1145               WOW Make your own 'slickers' !   
         28086  I've chewed this gum many times, but used?   
         28087                    Best sugarless gum ever!   
         
                                                             Text  \textbackslash{}
         70688  I bought a few of these after my apartment was{\ldots}   
         1146   This was a really good idea and the final prod{\ldots}   
         1145   I just received my shipment and could hardly w{\ldots}   
         28086  Nothing against the product, but it does bothe{\ldots}   
         28087  I love this stuff. It is sugar-free so it does{\ldots}   
         
                                                       Clean\_Text  \textbackslash{}
         70688  bought apartment infested fruit flies hours tr{\ldots}   
         1146   really good idea final product outstanding use{\ldots}   
         1145   received shipment could hardly wait try produc{\ldots}   
         28086  nothing product bother link top page buy used {\ldots}   
         28087  love stuff sugar free not rot gums tastes good{\ldots}   
         
                             Clean\_Summary  \textbackslash{}
         70688            sure death flies   
         1146                great product   
         1145           wow make islickers   
         28086  chewed gum many times used   
         28087     best sugarless gum ever   
         
                                                       Final\_Text  
         70688  bought apartment infested fruit flies hours tr{\ldots}  
         1146   really good idea final product outstanding use{\ldots}  
         1145   received shipment could hardly wait try produc{\ldots}  
         28086  nothing product bother link top page buy used {\ldots}  
         28087  love stuff sugar free not rot gums tastes good{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{X\PYZus{}Test}\PY{o}{.}\PY{n}{tail}\PY{p}{(}\PY{l+m+mi}{60}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}84}]:}            Id   ProductId          UserId  \textbackslash{}
         87501   95241  B00401OZ1U  A1KIL93AY6MFGS   
         63160   68621  B005IOXBY0  A1ORVAUR5C5N8X   
         66057   71787  B007RTR8AC  A2PZM8DT1KGT10   
         41621   45226  B00443Z35G  A3G23SMM1E1KPV   
         9513    10404  B005HI55CS  A36ERNIM0TKG3T   
         30235   32932  B001P05K8Q  A3L0B5NBTQ7ZHO   
         96778  105165  B005EF0HZ4  A2A5Z7LC91EFVA   
         96779  105166  B005EF0HZ4  A1JXSMYVHFPWM1   
         32585   35471  B000WSHV1Q  A1YT628H711FN7   
         96263  104607  B000FACFIA  A1TTGEM50SIS2R   
         75382   82028  B0019GZ7Z2   ANSBPV2CZVZ39   
         7451     8135  B0019GVYR2   ACSO5EDO1UMZ5   
         69746   75882  B002W1F6TK   ANSBPV2CZVZ39   
         24496   26772  B004ZY4TK4   A4IL0CLL27Q33   
         86066   93711  B001NZPFB0  A3318V6FJ2KIII   
         75877   82567  B008FXKOI2  A3RKYD8IUC5S0N   
         84914   92421  B007TGDXMK  A1BSGNCHEI1PJI   
         5472     5924  B00523NRVO  A2JDXKFZ0PFHKU   
         38043   41317  B008NDSNAU  A2Z0XFW79HXASE   
         19181   20930  B001L1MKLY  A38XYFHXEUNUW6   
         85745   93367  B007TGDXMU   AAMUNRK134Y5P   
         85744   93366  B007TGDXMU   AGUBQN9M09VQ4   
         85743   93365  B007TGDXMU   A9JMG87TELB6N   
         55730   60463  B003QNJYXM   AYTSBGA5A3UWI   
         55731   60464  B003QNJYXM  A2E2F8WSUB33VE   
         55158   59851  B001EQ5KTK  A3GS4GWPIBV0NT   
         83618   91002  B001E5E470   AGADB4E6N1EDS   
         8731     9564  B001EQ5IPQ   AA2104NO2VE8H   
         78920   85816  B005XGH78E  A2YGWCOC3LM3KH   
         93098  101227  B006N0KV8W  A1OA7ZKRQH98C8   
         42269   45991  B007VQQT1K  A34P4V70RNC2YV   
         76059   82772  B0049K99RW  A1Y73Y4VX3AJMZ   
         25112   27424  B003WEFSAI  A37O0JPLJ8BOXP   
         29158   31794  B0049D7HRS  A3LR9HCV3D96I3   
         87843   95629  B000LKXDXU  A2J3PR6J36UTVH   
         97624  106071  B007JTKEQK  A1DOMJI7GXGPNY   
         14526   15842  B007TJGZ5E  A3UOYYQS5Z47MS   
         14300   15605  B000255OIG   AUINI96NMGXUI   
         14299   15604  B000255OIG  A3SSEJ8IEM4YGW   
         82884   90215  B00866AM2G   ADTOX2JFWWA0B   
         82885   90216  B00866AM2G   AY839W9JQDZM2   
         15069   16426  B007TJGZ54  A29BJSTYH9W3JI   
         43703   47562  B004M0Y8T8  A2QJS6MHTIFSRI   
         13539   14784  B000S859NC  A2H7STZ2URUCOE   
         52220   56723  B0012XBD7I  A32NC2UF34RJQY   
         55100   59787  B002K9BG16  A30A7W9CZ77GFY   
         89213   97089  B004O8KBK8  A1JPKFGGF128X1   
         6548     7178  B004OQLIHK   AKHQMSUORSA91   
         60967   66252  B007OSBGOK   A10QOESY9VJ9K   
         43268   47077  B001C4PKIK  A3IMXYITIO8WHN   
         16026   17512  B0045Z6K50  A3HM6TNYB7FNDL   
         90340   98294  B0002LY6W0  A1BX08Y0GIT5RU   
         76594   83330  B005ZBZLT4   AAMUNRK134Y5P   
         78715   85601  B003ZURM80  A1O6MADFNBRX7H   
         50708   55049  B000IHJEDE  A2DFSA2JXQKVY3   
         76593   83329  B005ZBZLT4  A308RR8J9NJOOZ   
         22401   24518  B0016JJEFG   AO9WE22147CRH   
         56673   61474  B005YVU4A6  A2LU545SISQOJ8   
         37074   40274  B005VOOT52  A2FKFQQPU498JT   
         5259     5703  B009WSNWC4   AMP7K1O84DH1T   
         
                                                     ProfileName  HelpfulnessNumerator  \textbackslash{}
         87501                                      John K. Kirk                     0   
         63160                                        amondigirl                     0   
         66057                    Edwina E. Cowgill "book lover"                     0   
         41621                                       L. E. Scott                     0   
         9513                                   Donald E. Bolton                     0   
         30235                                             Julie                     0   
         96778                                    Gretchen Casey                     0   
         96779                                    marsha m beers                     0   
         32585                                      Laura Tomevi                     0   
         96263                                              Abby                     0   
         75382                               zena3546 "zena3546"                     0   
         7451                                       SeekingBodhi                     0   
         69746                               zena3546 "zena3546"                     0   
         24496                                        D. Brennan                     0   
         86066                                         T. Dennis                     0   
         75877                                     Foureyedsnail                     0   
         84914                    Kelly Bowser "Runs W Scissors"                     0   
         5472                                   James W. Shondel                     0   
         38043                         Kelby Scandrett "Kaiahso"                     0   
         19181                                         bleaufire                     0   
         85745                                         Tony Schy                     0   
         85744                                     Inger Jackson                     0   
         85743                                    Ludmila Newman                     0   
         55730                                         Imran Ali                     0   
         55731                                  Maria A. Alfonzo                     0   
         55158                            R. Chester "ricki1966"                     0   
         83618                    L. A. Stephenson "Mom of four"                     0   
         8731                                Lakshminarayan Iyer                     0   
         78920                                Luke R. McAllister                     0   
         93098                                           M Mills                     0   
         42269                                           S. Guss                     0   
         76059                                     Rispir Chrone                     0   
         25112                                      Texaschick59                     0   
         29158                                      Gypsy Healer                     0   
         87843                                             Joyce                     0   
         97624                                             Jyouk                     0   
         14526                            David A. Levin "DaveL"                     0   
         14300                                           Kkrys23                     0   
         14299                                           Seagaul                     0   
         82884                                        Arnos Vale                     0   
         82885                                          Daniella                     0   
         15069                                             Harry                     0   
         43703                                           Georgie                     0   
         13539                 Christopher Whedon "the odd bead"                     0   
         52220                                   D. Pagliassotti                     0   
         55100                    Cecelia Thomas "Lady Kinrowan"                     0   
         89213                                            MTNick                     0   
         6548                                           Pen Name                     0   
         60967                                              Gina                     0   
         43268                                 Thomas R. Jackson                     0   
         16026                                         C. Furman                     0   
         90340  L. Nguyen "Always on the lookout for a good d{\ldots}                     0   
         76594                                         Tony Schy                     0   
         78715                                       Denise Lake                     0   
         50708                                            C-Rush                     0   
         76593                                              Josh                     0   
         22401                                      Arvind Rajan                     0   
         56673                                             Kelly                     0   
         37074                                                cc                     0   
         5259                                               ESTY                     0   
         
                HelpfulnessDenominator  Score        Time  \textbackslash{}
         87501                       0      1  1351209600   
         63160                       0      1  1351209600   
         66057                       0      1  1351209600   
         41621                       0      1  1351209600   
         9513                        0      1  1351209600   
         30235                       0      1  1351209600   
         96778                       0      1  1351209600   
         96779                       0      0  1351209600   
         32585                       0      1  1351209600   
         96263                       0      1  1351209600   
         75382                       0      1  1351209600   
         7451                        0      0  1351209600   
         69746                       0      0  1351209600   
         24496                       0      0  1351209600   
         86066                       0      1  1351209600   
         75877                       0      1  1351209600   
         84914                       0      1  1351209600   
         5472                        0      1  1351209600   
         38043                       0      1  1351209600   
         19181                       0      1  1351209600   
         85745                       0      1  1351209600   
         85744                       0      0  1351209600   
         85743                       0      1  1351209600   
         55730                       0      1  1351209600   
         55731                       0      1  1351209600   
         55158                       0      1  1351209600   
         83618                       0      1  1351209600   
         8731                        0      0  1351209600   
         78920                       0      1  1351209600   
         93098                       0      1  1351209600   
         42269                       0      1  1351209600   
         76059                       0      1  1351209600   
         25112                       0      1  1351209600   
         29158                       0      1  1351209600   
         87843                       0      1  1351209600   
         97624                       0      1  1351209600   
         14526                       0      1  1351209600   
         14300                       0      1  1351209600   
         14299                       0      1  1351209600   
         82884                       0      1  1351209600   
         82885                       0      1  1351209600   
         15069                       0      1  1351209600   
         43703                       0      1  1351209600   
         13539                       0      1  1351209600   
         52220                       0      1  1351209600   
         55100                       0      1  1351209600   
         89213                       0      1  1351209600   
         6548                        0      1  1351209600   
         60967                       0      1  1351209600   
         43268                       0      1  1351209600   
         16026                       0      1  1351209600   
         90340                       0      1  1351209600   
         76594                       0      1  1351209600   
         78715                       0      1  1351209600   
         50708                       0      1  1351209600   
         76593                       0      1  1351209600   
         22401                       0      0  1351209600   
         56673                       0      1  1351209600   
         37074                       0      1  1351209600   
         5259                        0      1  1351209600   
         
                                                          Summary  \textbackslash{}
         87501                                 Metromint or Bust!   
         63160                                           WOW{\ldots}   
         66057                                   Fabulous Shampoo   
         41621                             Great Swedish Pastries   
         9513                          Hidden Springs Maple syrup   
         30235                       Great results but they stink   
         96778                                    Gluten Free Kid   
         96779                                       Disappointed   
         32585                                        Great Treat   
         96263                         Licorice Scottie Dogs, Red   
         75382                                      Great product   
         7451                                           NEWSFLASH   
         69746                                    terrible treats   
         24496                                       Buyer beware   
         86066            My dog enjoys it and it helps her hips.   
         75877                                   Tasty and works!   
         84914                             Very Nice Medium Roast   
         5472                                    The perfect pop!   
         38043                                                Yum   
         19181                                     Yummy \& Subtle   
         85745                                       Very pleased   
         85744                                Not what I expected   
         85743                             Best coffee I ever had   
         55730                               A God Sent Remedy!!!   
         55731                                           Excelent   
         55158                                      Love this tea   
         83618                              Help for a Lousy Cook   
         8731                              Extremely dissapointed   
         78920               Great flavor - spicy but not too hot   
         93098                                      no complaints   
         42269                                    Great Irish Tea   
         76059                              Nice traditional chai   
         25112                                          Drink mix   
         29158                                          Delicious   
         87843              Michael Seasons Unsalted Potato Chips   
         97624  Ain't no coconut water better than Sun Tropics{\ldots}   
         14526                                     Morning Coffee   
         14300                                   Love this faucet   
         14299                                      Dogs love it.   
         82884                                           Love it.   
         82885                                        I love this   
         15069                                       super coffee   
         43703                              Sleeping a lot better   
         13539                                          GREAT TEA   
         52220                                 Great for HS lunch   
         55100  Butler's chocolate is the real deal direct fro{\ldots}   
         89213                                  Yummy and Healthy   
         6548                                          Delicious!   
         60967                                 So many varieties!   
         43268                                        Great food!   
         16026          Full- bodied without a bitter after-taste   
         90340                  The BEST fig spread on the market   
         76594                           Product is good, but{\ldots}   
         78715                       5 Star Tea at a super price!   
         50708                                           Not bad.   
         76593                                   One of the best!   
         22401                                    bad tasting tea   
         56673                                             Chike!   
         37074                                   chocolate heaven   
         5259                                           DELICIOUS   
         
                                                             Text  \textbackslash{}
         87501  Chilled Oragemint is a classic refreshment for{\ldots}   
         63160  This chocolate is amazing..I love the taste an{\ldots}   
         66057  The name says it all- Clear Scalp and Hair  - {\ldots}   
         41621  Svenhard's varity pack pastries are great.  In{\ldots}   
         9513   This is one of the very finest maple syrups I {\ldots}   
         30235  We originally purchased these chews from our v{\ldots}   
         96778  We LOVE Lucy's cookies!  The Maple Bliss are w{\ldots}   
         96779  I have not been able to find the Maple flavor {\ldots}   
         32585  My cats love these. They are very hard to find{\ldots}   
         96263  I love the Gimbals Red Licorice Scottie dogs I{\ldots}   
         75382  This is a wonderful flour to use. low carbs, a{\ldots}   
         7451   I just called Bob's Red Mill customer service {\ldots}   
         69746  My dogs love them but they are loaded with jun{\ldots}   
         24496  Nespresso makes GREAT coffee and GREAT machine{\ldots}   
         86066  My dog was diagnosed with hip dysplasia as a 6{\ldots}   
         75877  First off, my cat HATES regular Greenies (the {\ldots}   
         84914  This coffee has the best aroma!  Great medium {\ldots}   
         5472   These lollipops are are well done, look exactl{\ldots}   
         38043  Yum, Yum, Yum, Yum{\ldots}  (Munch, munch).  Yum!  {\ldots}   
         19181  Just made my first pot of this wonderful coffe{\ldots}   
         85745  Good price, good quality with convenience.  Fu{\ldots}   
         85744  First of all the "k-cups" were weird and the t{\ldots}   
         85743  This is the best coffee I have ever had. I hav{\ldots}   
         55730  I love this stuff! It's a God sent Remedy for {\ldots}   
         55731  Good price, flavor, fast delivery And good pre{\ldots}   
         55158  This is a favorite of mine for using over ice{\ldots}   
         83618  I'm a lousy cook and I know it.  However, when{\ldots}   
         8731   Hi,<br />I am very disappointed with the past {\ldots}   
         78920  I got some of this from a low sodium foods web{\ldots}   
         93098  I'm a huge fan of Jack Daniel's jelly, <a href{\ldots}   
         42269  We recently returned from a wonderful three we{\ldots}   
         76059  I got hooked on this chai when I decided to gi{\ldots}   
         25112  We love this drink mix it taste delicious and {\ldots}   
         29158  Individually packaged assorted rice crackers a{\ldots}   
         87843  These are the best chips ever!  They are unsal{\ldots}   
         97624  This is like young coconut in a can! It tastes{\ldots}   
         14526  Great coffee at a good price. I'm a subscripti{\ldots}   
         14300  Love this faucet.  My husband had installed th{\ldots}   
         14299  This is the "all gone" treat after dinner.  It{\ldots}   
         82884  I love this but think its a little to expensiv{\ldots}   
         82885  It's is in my opinion the best coconut water o{\ldots}   
         15069  Great coffee and so easy to brew.  This coffee{\ldots}   
         43703  Hubby and I (both 63) have been drinking about{\ldots}   
         13539  Rooibos Natural Red tea is something of a pers{\ldots}   
         52220  Great for HS lunch, kid enjoy as a snack also,{\ldots}   
         55100  Nifty hot chocolate discs added to your warm m{\ldots}   
         89213  Loved the cranberry-like flavor and slightly c{\ldots}   
         6548   I have ordered these raisins multiple times.  {\ldots}   
         60967  I love the assortment.  Different countries of{\ldots}   
         43268  I wanted a food for a a dog with skin problems{\ldots}   
         16026  This is my everyday coffee choice{\ldots}a good all{\ldots}   
         90340  This is my go to spread when I serve a cheese {\ldots}   
         76594  I like the product and the price point, but fo{\ldots}   
         78715  This tea is very good and perfect for the pric{\ldots}   
         50708  These are small and very salty. The taste is g{\ldots}   
         76593  I am recently new to the Keurig world.  I've t{\ldots}   
         22401  We drink a lot of tea{\ldots} from all over the wor{\ldots}   
         56673  Just tried the orange and iced coffee this mor{\ldots}   
         37074  Excellent smooth taste. Any one who loves choc{\ldots}   
         5259   Purchased this product at a local store in NY {\ldots}   
         
                                                       Clean\_Text  \textbackslash{}
         87501  chilled oragemint classic refreshment dry scra{\ldots}   
         63160  chocolate amazing love taste smell chocolate f{\ldots}   
         66057  name says clear scalp hair leaves hair clear p{\ldots}   
         41621  svenhard varity pack pastries great individual{\ldots}   
         9513   one finest maple syrups ordered enjoyed bought{\ldots}   
         30235  originally purchased chews veterinarian decide{\ldots}   
         96778  love lucy cookies maple bliss wonderful bad ha{\ldots}   
         96779  not able find maple flavor cookies area anywhe{\ldots}   
         32585  cats love hard find anywhere used available pe{\ldots}   
         96263  love gimbals red licorice scottie dogs purchas{\ldots}   
         75382  wonderful flour use low carbs full nutrients d{\ldots}   
         7451   called bob red mill customer service g search {\ldots}   
         69746  dogs love loaded junk come another country wen{\ldots}   
         24496  nespresso makes great coffee great machines sw{\ldots}   
         86066  dog diagnosed hip dysplasia old puppy vet said{\ldots}   
         75877  first cat hates regular greenies big crunchy o{\ldots}   
         84914  coffee best aroma great medium taste replaced {\ldots}   
         5472   lollipops well done look exactly like picture {\ldots}   
         38043  yum yum yum yum munch munch yum love tastes wo{\ldots}   
         19181  made first pot wonderful coffee simply delish {\ldots}   
         85745  good price good quality convenience fully met {\ldots}   
         85744  first k cups weird taste not thought would not{\ldots}   
         85743  best coffee ever keurig coffee maker several y{\ldots}   
         55730  love stuff god sent remedy hangovers understan{\ldots}   
         55731  good price flavor fast delivery good presentat{\ldots}   
         55158  favorite mine using ice even bought give chris{\ldots}   
         83618  lousy cook know however kids grind little garl{\ldots}   
         8731   hi disappointed past shipment received one coc{\ldots}   
         78920  got low sodium foods website not believe much {\ldots}   
         93098                         huge fan jack daniel jelly   
         42269  recently returned wonderful three week excursi{\ldots}   
         76059  got hooked chai decided give coffee still litt{\ldots}   
         25112  love drink mix taste delicious impossible yo f{\ldots}   
         29158  individually packaged assorted rice crackers r{\ldots}   
         87843  best chips ever unsalted low sodium diet criti{\ldots}   
         97624  like young coconut tastes like young coconut f{\ldots}   
         14526  great coffee good price subscription buyer buy{\ldots}   
         14300  love faucet husband installed one old house cu{\ldots}   
         14299  gone treat dinner treat dogs work run chance l{\ldots}   
         82884  love think little expensive everyday use refre{\ldots}   
         82885  opinion best coconut water especially since no{\ldots}   
         15069  great coffee easy brew coffee great aroma good{\ldots}   
         43703  hubby drinking oz night months found falling d{\ldots}   
         13539  rooibos natural red tea something personal tas{\ldots}   
         52220  great hs lunch kid enjoy snack also buy salted{\ldots}   
         55100  nifty hot chocolate discs added warm milk milk{\ldots}   
         89213  loved cranberry like flavor slightly crunchy t{\ldots}   
         6548   ordered raisins multiple times always great ar{\ldots}   
         60967  love assortment different countries origins fu{\ldots}   
         43268  wanted food dog skin problems skin greatly imp{\ldots}   
         16026  everyday coffee choice good around crowd pleas{\ldots}   
         90340  go spread serve cheese platter goes well soft {\ldots}   
         76594  like product price point flavor strong overpow{\ldots}   
         78715  tea good perfect price not go wrong product mu{\ldots}   
         50708  small salty taste good strong good thing packa{\ldots}   
         76593  recently new keurig world tried handful flavor{\ldots}   
         22401  drink lot tea world far worst tasting tea purc{\ldots}   
         56673  tried orange iced coffee morning really liked {\ldots}   
         37074  excellent smooth taste one loves chocolate enj{\ldots}   
         5259   purchased product local store ny kids love qui{\ldots}   
         
                                                    Clean\_Summary  \textbackslash{}
         87501                                     metromint bust   
         63160                                                wow   
         66057                                   fabulous shampoo   
         41621                             great swedish pastries   
         9513                          hidden springs maple syrup   
         30235                                great results stink   
         96778                                    gluten free kid   
         96779                                       disappointed   
         32585                                        great treat   
         96263                          licorice scottie dogs red   
         75382                                      great product   
         7451                                           newsflash   
         69746                                    terrible treats   
         24496                                       buyer beware   
         86066                              dog enjoys helps hips   
         75877                                        tasty works   
         84914                                  nice medium roast   
         5472                                         perfect pop   
         38043                                                yum   
         19181                                       yummy subtle   
         85745                                            pleased   
         85744                                       not expected   
         85743                                   best coffee ever   
         55730                                    god sent remedy   
         55731                                           excelent   
         55158                                           love tea   
         83618                                    help lousy cook   
         8731                              extremely dissapointed   
         78920                         great flavor spicy not hot   
         93098                                      no complaints   
         42269                                    great irish tea   
         76059                              nice traditional chai   
         25112                                          drink mix   
         29158                                          delicious   
         87843              michael seasons unsalted potato chips   
         97624  ai not no coconut water better sun tropics coc{\ldots}   
         14526                                     morning coffee   
         14300                                        love faucet   
         14299                                          dogs love   
         82884                                               love   
         82885                                               love   
         15069                                       super coffee   
         43703                                sleeping lot better   
         13539                                          great tea   
         52220                                     great hs lunch   
         55100          butler chocolate real deal direct ireland   
         89213                                      yummy healthy   
         6548                                           delicious   
         60967                                     many varieties   
         43268                                         great food   
         16026                   full bodied without bitter taste   
         90340                             best fig spread market   
         76594                                       product good   
         78715                               star tea super price   
         50708                                            not bad   
         76593                                           one best   
         22401                                    bad tasting tea   
         56673                                              chike   
         37074                                   chocolate heaven   
         5259                                           delicious   
         
                                                       Final\_Text  
         87501  chilled oragemint classic refreshment dry scra{\ldots}  
         63160  chocolate amazing love taste smell chocolate f{\ldots}  
         66057  name says clear scalp hair leaves hair clear p{\ldots}  
         41621  svenhard varity pack pastries great individual{\ldots}  
         9513   one finest maple syrups ordered enjoyed bought{\ldots}  
         30235  originally purchased chews veterinarian decide{\ldots}  
         96778  love lucy cookies maple bliss wonderful bad ha{\ldots}  
         96779  not able find maple flavor cookies area anywhe{\ldots}  
         32585  cats love hard find anywhere used available pe{\ldots}  
         96263  love gimbals red licorice scottie dogs purchas{\ldots}  
         75382  wonderful flour use low carbs full nutrients d{\ldots}  
         7451   called bob red mill customer service g search {\ldots}  
         69746  dogs love loaded junk come another country wen{\ldots}  
         24496  nespresso makes great coffee great machines sw{\ldots}  
         86066  dog diagnosed hip dysplasia old puppy vet said{\ldots}  
         75877  first cat hates regular greenies big crunchy o{\ldots}  
         84914  coffee best aroma great medium taste replaced {\ldots}  
         5472   lollipops well done look exactly like picture {\ldots}  
         38043  yum yum yum yum munch munch yum love tastes wo{\ldots}  
         19181  made first pot wonderful coffee simply delish {\ldots}  
         85745  good price good quality convenience fully met {\ldots}  
         85744  first k cups weird taste not thought would not{\ldots}  
         85743  best coffee ever keurig coffee maker several y{\ldots}  
         55730  love stuff god sent remedy hangovers understan{\ldots}  
         55731  good price flavor fast delivery good presentat{\ldots}  
         55158  favorite mine using ice even bought give chris{\ldots}  
         83618  lousy cook know however kids grind little garl{\ldots}  
         8731   hi disappointed past shipment received one coc{\ldots}  
         78920  got low sodium foods website not believe much {\ldots}  
         93098           huge fan jack daniel jelly no complaints  
         42269  recently returned wonderful three week excursi{\ldots}  
         76059  got hooked chai decided give coffee still litt{\ldots}  
         25112  love drink mix taste delicious impossible yo f{\ldots}  
         29158  individually packaged assorted rice crackers r{\ldots}  
         87843  best chips ever unsalted low sodium diet criti{\ldots}  
         97624  like young coconut tastes like young coconut f{\ldots}  
         14526  great coffee good price subscription buyer buy{\ldots}  
         14300  love faucet husband installed one old house cu{\ldots}  
         14299  gone treat dinner treat dogs work run chance l{\ldots}  
         82884  love think little expensive everyday use refre{\ldots}  
         82885  opinion best coconut water especially since no{\ldots}  
         15069  great coffee easy brew coffee great aroma good{\ldots}  
         43703  hubby drinking oz night months found falling d{\ldots}  
         13539  rooibos natural red tea something personal tas{\ldots}  
         52220  great hs lunch kid enjoy snack also buy salted{\ldots}  
         55100  nifty hot chocolate discs added warm milk milk{\ldots}  
         89213  loved cranberry like flavor slightly crunchy t{\ldots}  
         6548   ordered raisins multiple times always great ar{\ldots}  
         60967  love assortment different countries origins fu{\ldots}  
         43268  wanted food dog skin problems skin greatly imp{\ldots}  
         16026  everyday coffee choice good around crowd pleas{\ldots}  
         90340  go spread serve cheese platter goes well soft {\ldots}  
         76594  like product price point flavor strong overpow{\ldots}  
         78715  tea good perfect price not go wrong product mu{\ldots}  
         50708  small salty taste good strong good thing packa{\ldots}  
         76593  recently new keurig world tried handful flavor{\ldots}  
         22401  drink lot tea world far worst tasting tea purc{\ldots}  
         56673  tried orange iced coffee morning really liked {\ldots}  
         37074  excellent smooth taste one loves chocolate enj{\ldots}  
         5259   purchased product local store ny kids love qui{\ldots}  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}0}]:} \PY{n}{X\PYZus{}Train} \PY{o}{=} \PY{n}{X\PYZus{}Train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Final\PYZus{}Text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
        \PY{n}{X\PYZus{}Test} \PY{o}{=} \PY{n}{X\PYZus{}Test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Final\PYZus{}Text}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \textbf{Observation} The Dataset is splitted properly based on time

    \section{{[}5{]} Featurization}\label{featurization}

    \subsection{{[}5.1{]} BAG OF WORDS}\label{bag-of-words}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{c+c1}{\PYZsh{}BoW For Train}
         \PY{n}{count\PYZus{}vect} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{X\PYZus{}Train\PYZus{}BOW} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}Train}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}BoW For Test}
         \PY{n}{X\PYZus{}Test\PYZus{}BOW} \PY{o}{=} \PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Test}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{the shape of out Train BOW vectorizer }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}Train\PYZus{}BOW}\PY{o}{.}\PY{n}{get\PYZus{}shape}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{the shape of out Test BOW vectorizer }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}Test\PYZus{}BOW}\PY{o}{.}\PY{n}{get\PYZus{}shape}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
the shape of out Train BOW vectorizer  (61441, 47483)
the shape of out Test BOW vectorizer  (26332, 47483)

    \end{Verbatim}

    \subsection{{[}4.3{]} TF-IDF}\label{tf-idf}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{c+c1}{\PYZsh{}TF\PYZus{}IDF For Train}
         \PY{n}{tf\PYZus{}idf\PYZus{}vect} \PY{o}{=} \PY{n}{TfidfVectorizer}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{X\PYZus{}Train\PYZus{}TFIDF} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}Train}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}TF\PYZus{}IDF For Test}
         \PY{n}{X\PYZus{}Test\PYZus{}TFIDF} \PY{o}{=} \PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Test}\PY{p}{)}
         
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{the shape of out Train TFIDF vectorizer }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}Train\PYZus{}TFIDF}\PY{o}{.}\PY{n}{get\PYZus{}shape}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{the shape of out Test TFIDF vectorizer }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{X\PYZus{}Test\PYZus{}TFIDF}\PY{o}{.}\PY{n}{get\PYZus{}shape}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
the shape of out Train TFIDF vectorizer  (61441, 47483)
the shape of out Test TFIDF vectorizer  (26332, 47483)

    \end{Verbatim}

    \section{{[}5{]} Assignment 4: Apply Naive
Bayes}\label{assignment-4-apply-naive-bayes}

    \begin{verbatim}
<li><strong>Apply Multinomial NaiveBayes on these feature sets</strong>
    <ul>
        <li><font color='red'>SET 1:</font>Review text, preprocessed one converted into vectors using (BOW)</li>
        <li><font color='red'>SET 2:</font>Review text, preprocessed one converted into vectors using (TFIDF)</li>
    </ul>
</li>
<br>
<li><strong>The hyper paramter tuning(find best Alpha)</strong>
    <ul>
<li>Find the best hyper parameter which will give the maximum <a href='https://www.appliedaicourse.com/course/applied-ai-course-online/lessons/receiver-operating-characteristic-curve-roc-curve-and-auc-1/'>AUC</a> value</li>
<li>Consider a wide range of alpha values for hyperparameter tuning, start as low as 0.00001</li>
<li>Find the best hyper paramter using k-fold cross validation or simple cross validation data</li>
<li>Use gridsearch cv or randomsearch cv or you can also write your own for loops to do this task of hyperparameter tuning</li>
    </ul>
</li>
<br>
<li><strong>Feature importance</strong>
    <ul>
<li>Find the top 10 features of positive class and top 10 features of negative class for both feature sets <font color='red'>Set 1</font> and <font color='red'>Set 2</font> using values of `feature_log_prob_` parameter of  <a href='https://scikit-learn.org/stable/modules/generated/sklearn.naive_bayes.MultinomialNB.html'>MultinomialNB</a> and print their corresponding feature names</li>
    </ul>
</li>
<br>
<li><strong>Feature engineering</strong>
    <ul>
<li>To increase the performance of your model, you can also experiment with with feature engineering like :</li>
        <ul>
        <li>Taking length of reviews as another feature.</li>
        <li>Considering some features from review summary as well.</li>
    </ul>
    </ul>
</li>
<br>
<li><strong>Representation of results</strong>
    <ul>
<li>You need to plot the performance of model both on train data and cross validation data for each hyper parameter, like shown in the figure. Here on X-axis you will have alpha values, since they have a wide range, just to represent those alpha values on the graph, apply log function on those alpha values.
<img src='train_cv_auc.JPG' width=300px></li>
<li>Once after you found the best hyper parameter, you need to train your model with it, and find the AUC on test data and plot the ROC curve on both train and test.
<img src='train_test_auc.JPG' width=300px></li>
<li>Along with plotting ROC curve, you need to print the <a href='https://www.appliedaicourse.com/course/applied-ai-course-online/lessons/confusion-matrix-tpr-fpr-fnr-tnr-1/'>confusion matrix</a> with predicted and original labels of test data points. Please visualize your confusion matrices using <a href='https://seaborn.pydata.org/generated/seaborn.heatmap.html'>seaborn heatmaps.
<img src='confusion_matrix.png' width=300px></li>
    </ul>
</li>
<br>
<li><strong>Conclusion</strong>
    <ul>
<li>You need to summarize the results at the end of the notebook, summarize it in the table format. To print out a table please refer to this prettytable library<a href='http://zetcode.com/python/prettytable/'>  link</a> 
    <img src='summary.JPG' width=400px>
</li>
    </ul>
\end{verbatim}

    Note: Data Leakage

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  There will be an issue of data-leakage if you vectorize the entire
  data and then split it into train/cv/test.
\item
  To avoid the issue of data-leakag, make sure to split your data first
  and then vectorize it.
\item
  While vectorizing your data, apply the method fit\_transform() on you
  train data, and apply the method transform() on cv/test data.
\item
  For more details please go through this link.
\end{enumerate}

    \section{Applying Multinomial Naive
Bayes}\label{applying-multinomial-naive-bayes}

    \subsection{{[}5.1{]} Applying Naive Bayes on BOW, SET
1}\label{applying-naive-bayes-on-bow-set-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{c+c1}{\PYZsh{} Please write all the code with proper documentation}
         
         \PY{n}{alpha}\PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.0001}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{10000}\PY{p}{]}
         
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}auc\PYZus{}score}
         \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
         
         \PY{n}{nb}\PY{o}{=}\PY{n}{MultinomialNB}\PY{p}{(}\PY{p}{)}
         \PY{n}{parameters}\PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{alpha}\PY{p}{\PYZcb{}}
         \PY{n}{clf}\PY{o}{=}\PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{nb}\PY{p}{,} \PY{n}{parameters}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{roc\PYZus{}auc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}BOW}\PY{p}{,} \PY{n}{Y\PYZus{}Train}\PY{p}{)}
         
         \PY{n}{train\PYZus{}auc}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{train\PYZus{}auc\PYZus{}std}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{cv\PYZus{}auc}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{cv\PYZus{}auc\PYZus{}std}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std\PYZus{}test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
           
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{alpha}\PY{p}{,} \PY{n}{train\PYZus{}auc}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train AUC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{alpha}\PY{p}{,} \PY{n}{cv\PYZus{}auc}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CV AUC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Alpha: hyperparameter}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AUC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ERROR PLOTS}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\{'alpha': 0.1\}
MultinomialNB(alpha=0.1, class\_prior=None, fit\_prior=True)
0.9268449054725256

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{n}{optimal\PYZus{}NB}\PY{o}{=}\PY{n}{MultinomialNB}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{class\PYZus{}prior}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{fit\PYZus{}prior}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}BOW}\PY{p}{,} \PY{n}{Y\PYZus{}Train}\PY{p}{)}
         
         \PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{,} \PY{n}{thresholds}\PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{Y\PYZus{}Train}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}BOW}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{,} \PY{n}{thresholds}\PY{o}{=}\PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{Y\PYZus{}Test}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}Test\PYZus{}BOW}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{train\PYZus{}bow\PYZus{}acc} \PY{o}{=}\PY{n}{auc}\PY{p}{(}\PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{)}
         \PY{n}{test\PYZus{}bow\PYZus{}acc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{)}
                                                  
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train AUC =}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{train\PYZus{}bow\PYZus{}acc}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test AUC =}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{test\PYZus{}bow\PYZus{}acc}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{False Positive Rate: FPR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{True Positive Rate: TPR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ROC Curve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_64_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{{[}5.1.1{]} Top 10 important features of positive class
from SET
1}\label{top-10-important-features-of-positive-class-from-set-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{c+c1}{\PYZsh{} Please write all the code with proper documentation}
          
          \PY{n}{class\PYZus{}features}\PY{o}{=}\PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{feature\PYZus{}log\PYZus{}prob\PYZus{}}
          \PY{c+c1}{\PYZsh{}  row\PYZus{}0 is for \PYZsq{}negative\PYZsq{} class and row\PYZus{}1 is for \PYZsq{}positive\PYZsq{} class}
          \PY{n}{negative\PYZus{}features}\PY{o}{=}\PY{n}{class\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{positive\PYZus{}features}\PY{o}{=}\PY{n}{class\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{count\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Sorting \PYZsq{}positive\PYZus{}features\PYZsq{} in descending order using argsort()function. sorted\PYZus{}positive\PYZus{}features holds the index of top +ve features}
          
          \PY{n}{sorted\PYZus{}positive\PYZus{}features}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{positive\PYZus{}features}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Top 10 Important Features and their log probabilities For Positive Class :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}positive\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ \PYZhy{}\PYZhy{}\PYZgt{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s2}{  }\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{positive\PYZus{}features}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]


Top 10 Important Features and their log probabilities For Positive Class :


not	 -->	-3.754726  
great	 -->	-4.435263  
good	 -->	-4.500713  
like	 -->	-4.562124  
one	 -->	-4.910012  
love	 -->	-4.956622  
taste	 -->	-4.966760  
tea	 -->	-4.972744  
coffee	 -->	-4.998359  
flavor	 -->	-5.067164  

    \end{Verbatim}

    \subsubsection{{[}5.1.2{]} Top 10 important features of negative class
from SET
1}\label{top-10-important-features-of-negative-class-from-set-1}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{c+c1}{\PYZsh{} Please write all the code with proper documentation}
          
          \PY{c+c1}{\PYZsh{} Sorting \PYZsq{}positive\PYZus{}features\PYZsq{} in descending order using argsort()function. sorted\PYZus{}negative\PYZus{}features holds the index of top \PYZhy{}ve features}
          
          \PY{n}{sorted\PYZus{}negative\PYZus{}features}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{negative\PYZus{}features}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Top 10 Important Features and their log probabilities For Negative Class :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}negative\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ \PYZhy{}\PYZhy{}\PYZgt{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s2}{  }\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{negative\PYZus{}features}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]


Top 10 Important Features and their log probabilities For Negative Class :


not	 -->	-3.215333  
like	 -->	-4.370493  
taste	 -->	-4.629433  
would	 -->	-4.679110  
product	 -->	-4.713654  
one	 -->	-4.897358  
good	 -->	-5.006622  
coffee	 -->	-5.071734  
flavor	 -->	-5.142142  
no	 -->	-5.144805  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}105}]:} \PY{n}{class\PYZus{}names}\PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Train confusion matrix}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{array} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{Y\PYZus{}Train}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}BOW}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{df\PYZus{}cm} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{array}\PY{p}{,} \PY{n}{index} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{,}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{df\PYZus{}cm}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{fmt}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Actual Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Predicted Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train confusion matrix

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_69_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n}{class\PYZus{}names}\PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test confusion matrix}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{array} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{Y\PYZus{}Test}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Test\PYZus{}BOW}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{df\PYZus{}cm} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{array}\PY{p}{,} \PY{n}{index} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{,}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{df\PYZus{}cm}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{fmt}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Actual Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Predicted Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Test confusion matrix

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_70_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{{[}5.2{]} Applying Naive Bayes on TFIDF, SET
2}\label{applying-naive-bayes-on-tfidf-set-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{c+c1}{\PYZsh{} Please write all the code with proper documentation}
          
          \PY{n}{alpha}\PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.0001}\PY{p}{,}\PY{l+m+mf}{0.001}\PY{p}{,}\PY{l+m+mf}{0.01}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{10000}\PY{p}{]}
          
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}auc\PYZus{}score}
          \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
          
          \PY{n}{nb}\PY{o}{=}\PY{n}{MultinomialNB}\PY{p}{(}\PY{p}{)}
          \PY{n}{parameters}\PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{alpha}\PY{p}{\PYZcb{}}
          \PY{n}{clf}\PY{o}{=}\PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{nb}\PY{p}{,} \PY{n}{parameters}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{roc\PYZus{}auc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}TFIDF}\PY{p}{,} \PY{n}{Y\PYZus{}Train}\PY{p}{)}
          
          \PY{n}{train\PYZus{}auc}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{train\PYZus{}auc\PYZus{}std}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std\PYZus{}train\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{cv\PYZus{}auc}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean\PYZus{}test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n}{cv\PYZus{}auc\PYZus{}std}\PY{o}{=}\PY{n}{clf}\PY{o}{.}\PY{n}{cv\PYZus{}results\PYZus{}}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std\PYZus{}test\PYZus{}score}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{alpha}\PY{p}{,} \PY{n}{train\PYZus{}auc}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train AUC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{alpha}\PY{p}{,} \PY{n}{cv\PYZus{}auc}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CV AUC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Alpha: hyperparameter}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{AUC}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xscale}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{log}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ERROR PLOTS}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_72_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}\PY{p}{)}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{clf}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
\{'alpha': 0.1\}
MultinomialNB(alpha=0.1, class\_prior=None, fit\_prior=True)
0.9251392170134956

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{optimal\PYZus{}NB}\PY{o}{=}\PY{n}{MultinomialNB}\PY{p}{(}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{class\PYZus{}prior}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{fit\PYZus{}prior}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}TFIDF}\PY{p}{,} \PY{n}{Y\PYZus{}Train}\PY{p}{)}
          
          \PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{,} \PY{n}{thresholds}\PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{Y\PYZus{}Train}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}TFIDF}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          \PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{,} \PY{n}{thresholds}\PY{o}{=}\PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{Y\PYZus{}Test}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}Test\PYZus{}TFIDF}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
          \PY{n}{train\PYZus{}TFIDF\PYZus{}acc} \PY{o}{=}\PY{n}{auc}\PY{p}{(}\PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{)}
          \PY{n}{test\PYZus{}TFIDF\PYZus{}acc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{)}
                                                   
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train AUC =}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{train\PYZus{}TFIDF\PYZus{}acc}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test AUC =}\PY{l+s+s2}{\PYZdq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{test\PYZus{}TFIDF\PYZus{}acc}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{False Positive Rate: FPR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{True Positive Rate: TPR}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ROC Curve}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{{[}5.2.1{]} Top 10 important features of positive class
from SET
2}\label{top-10-important-features-of-positive-class-from-set-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{c+c1}{\PYZsh{} Please write all the code with proper documentation}
          
          \PY{n}{class\PYZus{}features}\PY{o}{=}\PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{feature\PYZus{}log\PYZus{}prob\PYZus{}}
          \PY{c+c1}{\PYZsh{}  row\PYZus{}0 is for \PYZsq{}negative\PYZsq{} class and row\PYZus{}1 is for \PYZsq{}positive\PYZsq{} class}
          \PY{n}{negative\PYZus{}features}\PY{o}{=}\PY{n}{class\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
          \PY{n}{positive\PYZus{}features}\PY{o}{=}\PY{n}{class\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n}{feature\PYZus{}names}\PY{o}{=}\PY{n}{tf\PYZus{}idf\PYZus{}vect}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Sorting \PYZsq{}positive\PYZus{}features\PYZsq{} in descending order using argsort()function. sorted\PYZus{}positive\PYZus{}features holds the index of top +ve features}
          
          \PY{n}{sorted\PYZus{}positive\PYZus{}features}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{positive\PYZus{}features}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Top 10 Important Features and their log probabilities For Positive Class :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}positive\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ \PYZhy{}\PYZhy{}\PYZgt{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s2}{  }\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{positive\PYZus{}features}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]


Top 10 Important Features and their log probabilities For Positive Class :


not	 -->	-4.910125  
great	 -->	-4.978739  
good	 -->	-5.131800  
tea	 -->	-5.269179  
coffee	 -->	-5.273769  
love	 -->	-5.340229  
like	 -->	-5.359322  
best	 -->	-5.530332  
product	 -->	-5.544479  
taste	 -->	-5.564590  

    \end{Verbatim}

    \subsubsection{{[}5.2.2{]} Top 10 important features of negative class
from SET
2}\label{top-10-important-features-of-negative-class-from-set-2}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{c+c1}{\PYZsh{} Please write all the code with proper documentation}
          
          \PY{c+c1}{\PYZsh{} Sorting \PYZsq{}positive\PYZus{}features\PYZsq{} in descending order using argsort()function. sorted\PYZus{}negative\PYZus{}features holds the index of top \PYZhy{}ve features}
          
          \PY{n}{sorted\PYZus{}negative\PYZus{}features}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{n}{negative\PYZus{}features}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{Top 10 Important Features and their log probabilities For Negative Class :}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{sorted\PYZus{}negative\PYZus{}features}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+s2}{ \PYZhy{}\PYZhy{}\PYZgt{}}\PY{l+s+se}{\PYZbs{}t}\PY{l+s+si}{\PYZpc{}f}\PY{l+s+s2}{  }\PY{l+s+s2}{\PYZdq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{p}{,} \PY{n}{negative\PYZus{}features}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]


Top 10 Important Features and their log probabilities For Negative Class :


not	 -->	-4.333759  
like	 -->	-5.178132  
taste	 -->	-5.262192  
would	 -->	-5.381201  
product	 -->	-5.384952  
coffee	 -->	-5.477971  
one	 -->	-5.675929  
flavor	 -->	-5.733125  
no	 -->	-5.774436  
good	 -->	-5.791238  

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{class\PYZus{}names}\PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Train confusion matrix}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{array} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{Y\PYZus{}Train}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Train\PYZus{}TFIDF}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{df\PYZus{}cm} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{array}\PY{p}{,} \PY{n}{index} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{,}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{df\PYZus{}cm}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{fmt}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Actual Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Predicted Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Train confusion matrix

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_79_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{class\PYZus{}names}\PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{negative}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{positive}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test confusion matrix}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{array} \PY{o}{=} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{Y\PYZus{}Test}\PY{p}{,} \PY{n}{optimal\PYZus{}NB}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Test\PYZus{}TFIDF}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{df\PYZus{}cm} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{array}\PY{p}{,} \PY{n}{index} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{,}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{class\PYZus{}names}\PY{p}{]}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{df\PYZus{}cm}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{fmt}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{d}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Actual Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Predicted Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Test confusion matrix

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{{[}6{]} Conclusions}\label{conclusions}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{c+c1}{\PYZsh{} Please compare all your models using Prettytable library}
          \PY{k+kn}{from} \PY{n+nn}{prettytable} \PY{k}{import} \PY{n}{PrettyTable}
          
          \PY{n}{names}\PY{o}{=} \PY{p}{[}
                  \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Naive Bayes using BoW}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
          		    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Naive Bayes using TFIDF}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
          		    
          		\PY{p}{]}
          
            
          \PY{n}{optimal\PYZus{}Alpha}\PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{]}
          
          \PY{n}{train\PYZus{}acc}\PY{o}{=} \PY{p}{[}
          			\PY{n}{train\PYZus{}bow\PYZus{}acc}\PY{p}{,}
          			\PY{n}{train\PYZus{}TFIDF\PYZus{}acc}\PY{p}{,}
          			\PY{p}{]}
          
          \PY{n}{test\PYZus{}acc} \PY{o}{=} \PY{p}{[}
          			\PY{n}{test\PYZus{}bow\PYZus{}acc}\PY{p}{,}
          			\PY{n}{test\PYZus{}TFIDF\PYZus{}acc}\PY{p}{,}
           \PY{p}{]}
          \PY{n}{numbering}\PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}
           
           
          \PY{c+c1}{\PYZsh{} Initializing prettytable}
           
          \PY{n}{ptable}\PY{o}{=}\PY{n}{PrettyTable}\PY{p}{(}\PY{p}{)}
           
           \PY{c+c1}{\PYZsh{} Adding columns}
          \PY{n}{ptable}\PY{o}{.}\PY{n}{add\PYZus{}column}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{S.NO.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{numbering}\PY{p}{)}
          \PY{n}{ptable}\PY{o}{.}\PY{n}{add\PYZus{}column}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{MODEL}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{names}\PY{p}{)}
          \PY{n}{ptable}\PY{o}{.}\PY{n}{add\PYZus{}column}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Best Alpha}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{optimal\PYZus{}Alpha}\PY{p}{)}
          \PY{n}{ptable}\PY{o}{.}\PY{n}{add\PYZus{}column}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Training Accuracy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{train\PYZus{}acc}\PY{p}{)}
          \PY{n}{ptable}\PY{o}{.}\PY{n}{add\PYZus{}column}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test Accuracy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{test\PYZus{}acc}\PY{p}{)}
           
          \PY{c+c1}{\PYZsh{} Printing the Table}
          \PY{n+nb}{print}\PY{p}{(}\PY{n}{ptable}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
+-------+-------------------------+------------+--------------------+--------------------+
| S.NO. |          MODEL          | Best Alpha | Training Accuracy  |   Test Accuracy    |
+-------+-------------------------+------------+--------------------+--------------------+
|   1   |  Naive Bayes using BoW  |    0.1     | 0.9786779862041187 | 0.9324591958927195 |
|   2   | Naive Bayes using TFIDF |    0.1     | 0.9776249946439329 | 0.940563229328619  |
+-------+-------------------------+------------+--------------------+--------------------+

    \end{Verbatim}

    \textbf{Conclusion} :

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  I have taken 100000 data from SQL database.
\item
  After that I have cleaned the summary and text of the reviews.
\item
  Merge the Summary and text into new text column.
\item
  Sort the dataset based on time.
\item
  Split the dataset into Train and Test based on time.
\item
  Applied BOW, TFIDF on review text.
\item
  Applied MultinomialNB on BOW andTFIDF.
\item
  Inplemented grid Search.
\item
  Implemented confusion matrix and AOC to see the TP and TN. .
\end{enumerate}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
